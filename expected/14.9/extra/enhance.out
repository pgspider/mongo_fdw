-- Before running this file User must create database enhance_regress
-- databases on MongoDB with all permission for
-- user with password and ran mongodb_init.sh
-- file to load collections.
\set ECHO none
SET datestyle TO ISO;
CREATE EXTENSION IF NOT EXISTS mongo_fdw;
CREATE SERVER mongo_server FOREIGN DATA WRAPPER mongo_fdw  OPTIONS (address :MONGO_HOST, port :MONGO_PORT);
CREATE USER MAPPING FOR public SERVER mongo_server;
CREATE FOREIGN TABLE tbl_pushdown (_id int, c1 text, c2 varchar(255), c3 char(255), c4 bigint, c5 float8, c6 int, c7 json, c8 jsonb, c9 timestamp, c10 bool) SERVER mongo_server OPTIONS (database 'enhance_regress', collection 'tbl_pushdown');
--select aggregate funcs with just having
--Testcase 1:
EXPLAIN VERBOSE SELECT count(*), count(c1), min(c2), max(c3), sum(c6) FROM tbl_pushdown HAVING min(c5) < max(c4);
                                                                                                                         QUERY PLAN                                                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=17.50..17.52 rows=1 width=88)
   Output: count(*), count(c1), min((c2)::text), max(c3), sum(c6)
   Filter: (min(tbl_pushdown.c5) < (max(tbl_pushdown.c4))::double precision)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1592)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 2:
SELECT count(*), count(c1), min(c2), max(c3), sum(c6) FROM tbl_pushdown HAVING min(c5) < max(c4);
 count | count |      min      |                                                                                                                                       max                                                                                                                                       | sum  
-------+-------+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------
    10 |    10 | ~!@#$%^&*()_+ | システム設計検討資料チャート作成                                                                                                                                                                                                                                                | 1229
(1 row)

--Testcase 3:
EXPLAIN VERBOSE SELECT array_agg(c3 || ' ' || c1) FROM tbl_pushdown HAVING min(c4) <> 0;
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=12.50..12.51 rows=1 width=32)
   Output: array_agg((((c3)::text || ' '::text) || c1))
   Filter: (min(tbl_pushdown.c4) <> 0)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1064)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 4:
SELECT array_agg(c3 || ' ' || c1) FROM tbl_pushdown HAVING min(c4) <> 0;
                                                                                                                                                            array_agg                                                                                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"มีวันที่ดี paintings","<town>Toronto</town> txid txid","()ƯEFJAF quantiry","\\\\1132165131651316153 naming it á ú í à","interval MOẰNAJFK","<>?}|!@#$%^&*()_+ J%-2i30","~!@#$!@#!@#@# 格納用のドキュメント","que tenga un lindo día 030-1923=0","システム設計検討資料チャート作成 anything possible","Tjos os tres difficile Sort"}
(1 row)

--Testcase 5:
EXPLAIN VERBOSE SELECT array_agg(c1 || ':' || c2 ORDER BY c1, c2) FROM tbl_pushdown HAVING min(c4) <> 0;
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=10.00..10.01 rows=1 width=32)
   Output: array_agg(((c1 || ':'::text) || (c2)::text) ORDER BY c1, c2)
   Filter: (min(tbl_pushdown.c4) <> 0)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=556)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 6:
SELECT array_agg(c1 || ':' || c2 ORDER BY c1, c2) FROM tbl_pushdown HAVING min(c4) <> 0;
                                                                                                                     array_agg                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {030-1923=0:~!@#$%^&*()_+,"anything possible:JFQO#@(JWAE)@",J%-2i30:akejf923!O@,"MOẰNAJFK:fat20 & ()\\\\","naming it á ú í à:ごきげんよう",paintings:012803192,quantiry:ハンサム,Sort:J#PR,"txid txid:сковорода","格納用のドキュメント:Đẹp trai"}
(1 row)

--Testcase 7:
EXPLAIN VERBOSE SELECT string_agg(c3, ' '), string_agg(c1, ' ') FROM tbl_pushdown HAVING max(c5) > 0;
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=10.01..10.02 rows=1 width=64)
   Output: string_agg((c3)::text, ' '::text), string_agg(c1, ' '::text)
   Filter: (max(tbl_pushdown.c5) > '0'::double precision)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1064)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 8:
SELECT string_agg(c3, ' '), string_agg(c1, ' ') FROM tbl_pushdown HAVING max(c5) > 0;
                                                                                    string_agg                                                                                     |                                                       string_agg                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------
 มีวันที่ดี <town>Toronto</town> ()ƯEFJAF \\1132165131651316153 interval <>?}|!@#$%^&*()_+ ~!@#$!@#!@#@# que tenga un lindo día システム設計検討資料チャート作成 Tjos os tres difficile | paintings txid txid quantiry naming it á ú í à MOẰNAJFK J%-2i30 格納用のドキュメント 030-1923=0 anything possible Sort
(1 row)

--Testcase 9:
EXPLAIN VERBOSE SELECT string_agg(c3, ':' ORDER BY c3), string_agg(c1, ',' ORDER BY c1) FROM tbl_pushdown HAVING max(c5) >= 0;
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=10.01..10.02 rows=1 width=64)
   Output: string_agg((c3)::text, ':'::text ORDER BY ((c3)::text)), string_agg(c1, ','::text ORDER BY c1)
   Filter: (max(tbl_pushdown.c5) >= '0'::double precision)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1064)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 10:
SELECT string_agg(c3, ':' ORDER BY c3), string_agg(c1, ',' ORDER BY c1) FROM tbl_pushdown HAVING max(c5) >= 0;
                                                                                    string_agg                                                                                     |                                                       string_agg                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------
 ~!@#$!@#!@#@#:<>?}|!@#$%^&*()_+:มีวันที่ดี:\\1132165131651316153:interval:que tenga un lindo día:Tjos os tres difficile:<town>Toronto</town>:()ƯEFJAF:システム設計検討資料チャート作成 | 030-1923=0,anything possible,J%-2i30,MOẰNAJFK,naming it á ú í à,paintings,quantiry,Sort,txid txid,格納用のドキュメント
(1 row)

--Testcase 11:
EXPLAIN VERBOSE SELECT string_agg(c3, c1) FROM tbl_pushdown HAVING min(c6) <> min(c4);
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=10.00..10.01 rows=1 width=32)
   Output: string_agg((c3)::text, c1)
   Filter: (min(tbl_pushdown.c6) <> min(tbl_pushdown.c4))
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1068)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 12:
SELECT string_agg(c3, c1) FROM tbl_pushdown HAVING min(c6) <> min(c4);
                                                                                                                                  string_agg                                                                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 มีวันที่ดีtxid txid<town>Toronto</town>quantiry()ƯEFJAFnaming it á ú í à\\1132165131651316153MOẰNAJFKintervalJ%-2i30<>?}|!@#$%^&*()_+格納用のドキュメント~!@#$!@#!@#@#030-1923=0que tenga un lindo díaanything possibleシステム設計検討資料チャート作成SortTjos os tres difficile
(1 row)

--Testcase 13:
EXPLAIN VERBOSE SELECT avg(c4), stddev(c4), stddev_pop(c5), stddev_samp(c6) FROM tbl_pushdown HAVING min(c6) <> 0;
                                                                                                                                                                                                                                     QUERY PLAN                                                                                                                                                                                                                                     
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=104)
   Output: (avg(c4)), (stddev(c4)), (stddev_pop(c5)), (stddev_samp(c6))
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$group" : { "_id" : {  }, "ref0" : { "$avg" : "$c4" }, "ref1" : { "$stdDevSamp" : "$c4" }, "ref2" : { "$stdDevPop" : "$c5" }, "ref3" : { "$stdDevSamp" : "$c6" }, "ref4" : { "$min" : "$c6" } } }, { "$match" : { "$expr" : { "$ne" : [ "$ref4", { "$numberInt" : "0" } ] } } }, { "$project" : { "ref0" : { "$numberInt" : "1" }, "ref1" : { "$numberInt" : "1" }, "ref2" : { "$numberInt" : "1" }, "ref3" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 14:
SELECT avg(c4), stddev(c4), stddev_pop(c5), stddev_samp(c6) FROM tbl_pushdown HAVING min(c6) <> 0;
   avg    |      stddev      |    stddev_pop     |   stddev_samp    
----------+------------------+-------------------+------------------
 921089.1 | 2902729.58002507 | 2948067.822460538 | 177.765419709359
(1 row)

--Testcase 15:
EXPLAIN VERBOSE SELECT count(DISTINCT c5) FROM tbl_pushdown HAVING min(c6) <> min(c4);
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=7.50..7.51 rows=1 width=8)
   Output: count(DISTINCT c5)
   Filter: (min(tbl_pushdown.c6) <> min(tbl_pushdown.c4))
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=20)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 16:
SELECT count(DISTINCT c5) FROM tbl_pushdown HAVING min(c6) <> min(c4);
 count 
-------
    10
(1 row)

--non-pushdown aggregate funcs with just having
--Testcase 17:
EXPLAIN VERBOSE SELECT json_agg((c1, '!@!*')), jsonb_agg(('_(*#', c2)), json_object_agg(c1, 'x'), jsonb_object_agg('y', c1) FROM tbl_pushdown HAVING min(c6) <> 0;
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=12.51..12.52 rows=1 width=128)
   Output: json_agg(ROW(c1, '!@!*')), jsonb_agg(ROW('_(*#', c2)), json_object_agg(c1, 'x'), jsonb_object_agg('y', c1)
   Filter: (min(tbl_pushdown.c6) <> 0)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=552)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 18:
SELECT json_agg((c1, '!@!*')), jsonb_agg(('_(*#', c2)), json_object_agg(c1, 'x'), jsonb_object_agg('y', c1) FROM tbl_pushdown HAVING min(c6) <> 0;
                   json_agg                   |                                                                                                                                                                                 jsonb_agg                                                                                                                                                                                 |                                                                                                   json_object_agg                                                                                                   | jsonb_object_agg 
----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------
 [{"f1":"paintings","f2":"!@!*"},            +| [{"f1": "_(*#", "f2": "012803192"}, {"f1": "_(*#", "f2": "сковорода"}, {"f1": "_(*#", "f2": "ハンサム"}, {"f1": "_(*#", "f2": "ごきげんよう"}, {"f1": "_(*#", "f2": "fat20 & ()\\\\"}, {"f1": "_(*#", "f2": "akejf923!O@"}, {"f1": "_(*#", "f2": "Đẹp trai"}, {"f1": "_(*#", "f2": "~!@#$%^&*()_+"}, {"f1": "_(*#", "f2": "JFQO#@(JWAE)@"}, {"f1": "_(*#", "f2": "J#PR"}] | { "paintings" : "x", "txid txid" : "x", "quantiry" : "x", "naming it á ú í à" : "x", "MOẰNAJFK" : "x", "J%-2i30" : "x", "格納用のドキュメント" : "x", "030-1923=0" : "x", "anything possible" : "x", "Sort" : "x" } | {"y": "Sort"}
  {"f1":"txid txid","f2":"!@!*"},            +|                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                     | 
  {"f1":"quantiry","f2":"!@!*"},             +|                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                     | 
  {"f1":"naming it á ú í à","f2":"!@!*"},    +|                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                     | 
  {"f1":"MOẰNAJFK","f2":"!@!*"},             +|                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                     | 
  {"f1":"J%-2i30","f2":"!@!*"},              +|                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                     | 
  {"f1":"格納用のドキュメント","f2":"!@!*"}, +|                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                     | 
  {"f1":"030-1923=0","f2":"!@!*"},           +|                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                     | 
  {"f1":"anything possible","f2":"!@!*"},    +|                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                     | 
  {"f1":"Sort","f2":"!@!*"}]                  |                                                                                                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                     | 
(1 row)

--Testcase 19:
EXPLAIN VERBOSE SELECT string_agg(c1::bytea, '\134'::bytea) FROM tbl_pushdown HAVING min(c6) <> 1;
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=10.00..10.01 rows=1 width=32)
   Output: string_agg((c1)::bytea, '\x5c'::bytea)
   Filter: (min(tbl_pushdown.c6) <> 1)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=36)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 20:
SELECT string_agg(c1::bytea, '\134'::bytea) FROM tbl_pushdown HAVING min(c6) <> 1;
                                                                                                                                   string_agg                                                                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 \x7061696e74696e67735c7478696420747869645c7175616e746972795c6e616d696e6720697420c3a120c3ba20c3ad20c3a05c4d4fe1bab04e414a464b5c4a252d326933305ce6a0bce7b48de794a8e381aee38389e382ade383a5e383a1e383b3e383885c3033302d313932333d305c616e797468696e6720706f737369626c655c536f7274
(1 row)

--select aggregate funcs, where, having
--Testcase 21:
EXPLAIN VERBOSE SELECT count(*), count(c1), min(c2), max(c3), sum(c6) FROM tbl_pushdown WHERE c1 IS NOT NULL HAVING min(c5) < max(c4);
                                                                                                                                               QUERY PLAN                                                                                                                                               
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=17.50..17.52 rows=1 width=88)
   Output: count(*), count(c1), min((c2)::text), max(c3), sum(c6)
   Filter: (min(tbl_pushdown.c5) < (max(tbl_pushdown.c4))::double precision)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1592)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c1" : { "$ne" : null } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 22:
SELECT count(*), count(c1), min(c2), max(c3), sum(c6) FROM tbl_pushdown WHERE c1 IS NOT NULL HAVING min(c5) < max(c4);
 count | count |      min      |                                                                                                                                       max                                                                                                                                       | sum  
-------+-------+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------
    10 |    10 | ~!@#$%^&*()_+ | システム設計検討資料チャート作成                                                                                                                                                                                                                                                | 1229
(1 row)

--Testcase 23:
EXPLAIN VERBOSE SELECT array_agg(c3 || ' ' || c1) FROM tbl_pushdown WHERE c2 != 'aes3r' HAVING min(c4) <> 0;
                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=12.50..12.51 rows=1 width=32)
   Output: array_agg((((c3)::text || ' '::text) || c1))
   Filter: (min(tbl_pushdown.c4) <> 0)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1064)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c2" : { "$ne" : "aes3r" } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 24:
SELECT array_agg(c3 || ' ' || c1) FROM tbl_pushdown WHERE c2 != 'aes3r' HAVING min(c4) <> 0;
                                                                                                                                                            array_agg                                                                                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {"มีวันที่ดี paintings","<town>Toronto</town> txid txid","()ƯEFJAF quantiry","\\\\1132165131651316153 naming it á ú í à","interval MOẰNAJFK","<>?}|!@#$%^&*()_+ J%-2i30","~!@#$!@#!@#@# 格納用のドキュメント","que tenga un lindo día 030-1923=0","システム設計検討資料チャート作成 anything possible","Tjos os tres difficile Sort"}
(1 row)

--Testcase 25:
EXPLAIN VERBOSE SELECT array_agg(c1 || ':' || c2 ORDER BY c1, c2) FROM tbl_pushdown WHERE c3 <> ')@' HAVING min(c4) <> 0;
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=10.00..10.01 rows=1 width=32)
   Output: array_agg(((c1 || ':'::text) || (c2)::text) ORDER BY c1, c2)
   Filter: (min(tbl_pushdown.c4) <> 0)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=556)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c3" : { "$ne" : ")@" } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 26:
SELECT array_agg(c1 || ':' || c2 ORDER BY c1, c2) FROM tbl_pushdown WHERE c3 <> ')@' HAVING min(c4) <> 0;
                                                                                                                     array_agg                                                                                                                     
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {030-1923=0:~!@#$%^&*()_+,"anything possible:JFQO#@(JWAE)@",J%-2i30:akejf923!O@,"MOẰNAJFK:fat20 & ()\\\\","naming it á ú í à:ごきげんよう",paintings:012803192,quantiry:ハンサム,Sort:J#PR,"txid txid:сковорода","格納用のドキュメント:Đẹp trai"}
(1 row)

--Testcase 27:
EXPLAIN VERBOSE SELECT string_agg(c3, ' '), string_agg(c1, ' ') FROM tbl_pushdown WHERE c1 != c2 HAVING max(c5) > 0;
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=10.01..10.02 rows=1 width=64)
   Output: string_agg((c3)::text, ' '::text), string_agg(c1, ' '::text)
   Filter: (max(tbl_pushdown.c5) > '0'::double precision)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1064)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c1" : { "$ne" : null } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 28:
SELECT string_agg(c3, ' '), string_agg(c1, ' ') FROM tbl_pushdown WHERE c1 != c2 HAVING max(c5) > 0;
                                                                                    string_agg                                                                                     |                                                       string_agg                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------
 มีวันที่ดี <town>Toronto</town> ()ƯEFJAF \\1132165131651316153 interval <>?}|!@#$%^&*()_+ ~!@#$!@#!@#@# que tenga un lindo día システム設計検討資料チャート作成 Tjos os tres difficile | paintings txid txid quantiry naming it á ú í à MOẰNAJFK J%-2i30 格納用のドキュメント 030-1923=0 anything possible Sort
(1 row)

--Testcase 29:
EXPLAIN VERBOSE SELECT string_agg(c3, ':' ORDER BY c3), string_agg(c1, ',' ORDER BY c1) FROM tbl_pushdown WHERE c4 <> 0 HAVING max(c5) > 0;
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=10.01..10.02 rows=1 width=64)
   Output: string_agg((c3)::text, ':'::text ORDER BY ((c3)::text)), string_agg(c1, ','::text ORDER BY c1)
   Filter: (max(tbl_pushdown.c5) > '0'::double precision)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1064)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c4" : { "$ne" : { "$numberInt" : "0" } } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 30:
SELECT string_agg(c3, ':' ORDER BY c3), string_agg(c1, ',' ORDER BY c1) FROM tbl_pushdown WHERE c4 <> 0 HAVING max(c5) > 0;
                                                                                    string_agg                                                                                     |                                                       string_agg                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------
 ~!@#$!@#!@#@#:<>?}|!@#$%^&*()_+:มีวันที่ดี:\\1132165131651316153:interval:que tenga un lindo día:Tjos os tres difficile:<town>Toronto</town>:()ƯEFJAF:システム設計検討資料チャート作成 | 030-1923=0,anything possible,J%-2i30,MOẰNAJFK,naming it á ú í à,paintings,quantiry,Sort,txid txid,格納用のドキュメント
(1 row)

--Testcase 31:
EXPLAIN VERBOSE SELECT string_agg(c3, c1) FROM tbl_pushdown WHERE c4 != 0 HAVING min(c6) <> min(c4);
                                                                                                                         QUERY PLAN                                                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=10.00..10.01 rows=1 width=32)
   Output: string_agg((c3)::text, c1)
   Filter: (min(tbl_pushdown.c6) <> min(tbl_pushdown.c4))
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1068)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c4" : { "$ne" : { "$numberInt" : "0" } } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 32:
SELECT string_agg(c3, c1) FROM tbl_pushdown WHERE c4 != 0 HAVING min(c6) <> min(c4);
                                                                                                                                  string_agg                                                                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 มีวันที่ดีtxid txid<town>Toronto</town>quantiry()ƯEFJAFnaming it á ú í à\\1132165131651316153MOẰNAJFKintervalJ%-2i30<>?}|!@#$%^&*()_+格納用のドキュメント~!@#$!@#!@#@#030-1923=0que tenga un lindo díaanything possibleシステム設計検討資料チャート作成SortTjos os tres difficile
(1 row)

--Testcase 33:
EXPLAIN VERBOSE SELECT avg(c4), stddev(c4), stddev_pop(c5), stddev_samp(c6) FROM tbl_pushdown WHERE c4 > 0 HAVING min(c6) <> 0;
                                                                                                                                                                                                                                                                    QUERY PLAN                                                                                                                                                                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=104)
   Output: (avg(c4)), (stddev(c4)), (stddev_pop(c5)), (stddev_samp(c6))
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "c4" : { "$gt" : { "$numberInt" : "0" } } } }, { "$group" : { "_id" : {  }, "ref0" : { "$avg" : "$c4" }, "ref1" : { "$stdDevSamp" : "$c4" }, "ref2" : { "$stdDevPop" : "$c5" }, "ref3" : { "$stdDevSamp" : "$c6" }, "ref4" : { "$min" : "$c6" } } }, { "$match" : { "$expr" : { "$ne" : [ "$ref4", { "$numberInt" : "0" } ] } } }, { "$project" : { "ref0" : { "$numberInt" : "1" }, "ref1" : { "$numberInt" : "1" }, "ref2" : { "$numberInt" : "1" }, "ref3" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 34:
SELECT avg(c4), stddev(c4), stddev_pop(c5), stddev_samp(c6) FROM tbl_pushdown WHERE c4 > 0 HAVING min(c6) <> 0;
     avg     |      stddev      |    stddev_pop     |   stddev_samp   
-------------+------------------+-------------------+-----------------
 1154367.125 | 3243797.58120582 | 3254231.453375047 | 191.44991885235
(1 row)

--Testcase 35:
EXPLAIN VERBOSE SELECT count(DISTINCT c5) FROM tbl_pushdown WHERE c6 > 0 HAVING min(c6) <> min(c4);
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=7.50..7.51 rows=1 width=8)
   Output: count(DISTINCT c5)
   Filter: (min(tbl_pushdown.c6) <> min(tbl_pushdown.c4))
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=20)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c6" : { "$gt" : { "$numberInt" : "0" } } } }, { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 36:
SELECT count(DISTINCT c5) FROM tbl_pushdown WHERE c6 > 0 HAVING min(c6) <> min(c4);
 count 
-------
     9
(1 row)

--non-pushdown aggregate funcs
--Testcase 37:
EXPLAIN VERBOSE SELECT every(c5 > 0) , every(c3 != '##') , every(c1 <> '&2') FROM tbl_pushdown WHERE c6 > 2 GROUP BY c6 HAVING (c6 >> 101) >= 12225;
                                                                                                                         QUERY PLAN                                                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=17.50..19.50 rows=200 width=7)
   Output: every((c5 > '0'::double precision)), every((c3 <> '##'::bpchar)), every((c1 <> '&2'::text)), c6
   Group Key: tbl_pushdown.c6
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1068)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: ((tbl_pushdown.c6 >> 101) >= 12225)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c6" : { "$gt" : { "$numberInt" : "2" } } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 38:
SELECT every(c5 > 0) , every(c3 != '##') , every(c1 <> '&2') FROM tbl_pushdown WHERE c6 > 2 GROUP BY c6 HAVING (c6 >> 101) >= 12225;
 every | every | every 
-------+-------+-------
(0 rows)

--Testcase 39:
EXPLAIN VERBOSE SELECT bool_and(c5 != 0 OR c4-c5 > 1) , bool_and(c5 != 0) FROM tbl_pushdown WHERE c4 != 0 GROUP BY c6 HAVING NOT (c6 << 97) > 1656;
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=20.00..22.00 rows=200 width=6)
   Output: bool_and(((c5 <> '0'::double precision) OR (((c4)::double precision - c5) > '1'::double precision))), bool_and((c5 <> '0'::double precision)), c6
   Group Key: tbl_pushdown.c6
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=20)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: ((tbl_pushdown.c6 << 97) <= 1656)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c4" : { "$ne" : { "$numberInt" : "0" } } } }, { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 40:
SELECT bool_and(c5 != 0 OR c4-c5 > 1) , bool_and(c5 != 0) FROM tbl_pushdown WHERE c4 != 0 GROUP BY c6 HAVING NOT (c6 << 97) > 1656;
 bool_and | bool_and 
----------+----------
 t        | t
 t        | t
 t        | t
 t        | t
 t        | t
 t        | t
 t        | t
 t        | t
 t        | t
 t        | t
(10 rows)

--aggregate group by
--Testcase 41:
EXPLAIN VERBOSE SELECT c1, c2, c3, c4, c5, c10 FROM tbl_pushdown GROUP BY c1, c2, c3, c4, c5, c10;
                                                                                                                                                           QUERY PLAN                                                                                                                                                           
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=1589)
   Output: c1, c2, c3, c4, c5, c10
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$group" : { "_id" : { "ref0" : "$c1", "ref1" : "$c2", "ref2" : "$c3", "ref3" : "$c4", "ref4" : "$c5", "ref5" : "$c10" } } }, { "$project" : { "ref0" : "$_id.ref0", "ref1" : "$_id.ref1", "ref2" : "$_id.ref2", "ref3" : "$_id.ref3", "ref4" : "$_id.ref4", "ref5" : "$_id.ref5" } } ] }
(4 rows)

--Testcase 42:
SELECT * FROM (
SELECT c1, c2, c3, c4, c5, c10 FROM tbl_pushdown GROUP BY c1, c2, c3, c4, c5, c10
) t ORDER BY 1, 2, 3, 4, 5, 6;
          c1          |      c2       |                                                                                                                                       c3                                                                                                                                        |   c4    |      c5      | c10 
----------------------+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+--------------+-----
 030-1923=0           | ~!@#$%^&*()_+ | que tenga un lindo día                                                                                                                                                                                                                                                          | 9182318 |   9839712.12 | f
 anything possible    | JFQO#@(JWAE)@ | システム設計検討資料チャート作成                                                                                                                                                                                                                                                |   23413 |     232.7634 | t
 J%-2i30              | akejf923!O@   | <>?}|!@#$%^&*()_+                                                                                                                                                                                                                                                               |  -23123 | 123123.91231 | f
 MOẰNAJFK             | fat20 & ()\\  | interval                                                                                                                                                                                                                                                                        |   23123 |      -0.1212 | f
 naming it á ú í à    | ごきげんよう  | \\1132165131651316153                                                                                                                                                                                                                                                           |     212 |       11.212 | f
 paintings            | 012803192     | มีวันที่ดี                                                                                                                                                                                                                                                                           |    4312 |    -1928.121 | t
 quantiry             | ハンサム      | ()ƯEFJAF                                                                                                                                                                                                                                                                        |     212 |      -212.12 | t
 Sort                 | J#PR          | Tjos os tres difficile                                                                                                                                                                                                                                                          |    1232 |       839.12 | f
 txid txid            | сковорода     | <town>Toronto</town>                                                                                                                                                                                                                                                            |     115 |        -53.2 | t
 格納用のドキュメント | Đẹp trai      | ~!@#$!@#!@#@#                                                                                                                                                                                                                                                                   |    -923 |    231.98394 | t
(10 rows)

--Testcase 43:
EXPLAIN VERBOSE SELECT c1, avg(c4), c2, sum(c6), c5 FROM tbl_pushdown GROUP BY c1, c2, c5;
                                                                                                                                                               QUERY PLAN                                                                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=596)
   Output: c1, (avg(c4)), c2, (sum(c6)), c5
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$group" : { "_id" : { "ref0" : "$c1", "ref2" : "$c2", "ref4" : "$c5" }, "ref1" : { "$avg" : "$c4" }, "ref3" : { "$sum" : "$c6" } } }, { "$project" : { "ref0" : "$_id.ref0", "ref2" : "$_id.ref2", "ref4" : "$_id.ref4", "ref1" : { "$numberInt" : "1" }, "ref3" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 44:
SELECT * FROM (
SELECT c1, avg(c4), c2, sum(c6), c5 FROM tbl_pushdown GROUP BY c1, c2, c5
) t ORDER BY 1, 2, 3, 4, 5;
          c1          |   avg   |      c2       | sum |      c5      
----------------------+---------+---------------+-----+--------------
 030-1923=0           | 9182318 | ~!@#$%^&*()_+ | 162 |   9839712.12
 anything possible    |   23413 | JFQO#@(JWAE)@ | 323 |     232.7634
 J%-2i30              |  -23123 | akejf923!O@   |  12 | 123123.91231
 MOẰNAJFK             |   23123 | fat20 & ()\\  | -12 |      -0.1212
 naming it á ú í à    |     212 | ごきげんよう  | 123 |       11.212
 paintings            |    4312 | 012803192     |  51 |    -1928.121
 quantiry             |     212 | ハンサム      |   2 |      -212.12
 Sort                 |    1232 | J#PR          | 535 |       839.12
 txid txid            |     115 | сковорода     |  10 |        -53.2
 格納用のドキュメント |    -923 | Đẹp trai      |  23 |    231.98394
(10 rows)

--Testcase 45:
EXPLAIN VERBOSE SELECT avg(c4), stddev(c4), stddev_pop(c5), stddev_samp(c6) FROM tbl_pushdown GROUP BY c1;
                                                                                                                                                                                                 QUERY PLAN                                                                                                                                                                                                  
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=136)
   Output: (avg(c4)), (stddev(c4)), (stddev_pop(c5)), (stddev_samp(c6)), c1
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$group" : { "_id" : { "ref4" : "$c1" }, "ref0" : { "$avg" : "$c4" }, "ref1" : { "$stdDevSamp" : "$c4" }, "ref2" : { "$stdDevPop" : "$c5" }, "ref3" : { "$stdDevSamp" : "$c6" } } }, { "$project" : { "ref4" : "$_id.ref4", "ref0" : { "$numberInt" : "1" }, "ref1" : { "$numberInt" : "1" }, "ref2" : { "$numberInt" : "1" }, "ref3" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 46:
SELECT * FROM (
SELECT avg(c4), stddev(c4), stddev_pop(c5), stddev_samp(c6) FROM tbl_pushdown GROUP BY c1
) t ORDER BY 1, 2, 3, 4;
   avg   | stddev | stddev_pop | stddev_samp 
---------+--------+------------+-------------
  -23123 |        |          0 |            
    -923 |        |          0 |            
     115 |        |          0 |            
     212 |        |          0 |            
     212 |        |          0 |            
    1232 |        |          0 |            
    4312 |        |          0 |            
   23123 |        |          0 |            
   23413 |        |          0 |            
 9182318 |        |          0 |            
(10 rows)

--Testcase 47:
EXPLAIN VERBOSE SELECT array_agg(c1 || ':' || c2) FROM tbl_pushdown GROUP BY c1, c2;
                                                           QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=12.50..15.00 rows=200 width=580)
   Output: array_agg(((c1 || ':'::text) || (c2)::text)), c1, c2
   Group Key: tbl_pushdown.c1, tbl_pushdown.c2
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=548)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 48:
SELECT array_agg(c1 || ':' || c2) FROM tbl_pushdown GROUP BY c1, c2;
              array_agg              
-------------------------------------
 {"anything possible:JFQO#@(JWAE)@"}
 {"txid txid:сковорода"}
 {J%-2i30:akejf923!O@}
 {paintings:012803192}
 {"MOẰNAJFK:fat20 & ()\\\\"}
 {"naming it á ú í à:ごきげんよう"}
 {Sort:J#PR}
 {030-1923=0:~!@#$%^&*()_+}
 {quantiry:ハンサム}
 {"格納用のドキュメント:Đẹp trai"}
(10 rows)

--Testcase 49:
EXPLAIN VERBOSE SELECT c1 || 'aef2', c3 || c9, c10, c5+c6 FROM tbl_pushdown GROUP BY 1, 2, 3, 4;
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=27.50..38.50 rows=400 width=73)
   Output: ((c1 || 'aef2'::text)), (((c3)::text || (c9)::text)), c10, ((c5 + (c6)::double precision))
   Group Key: (tbl_pushdown.c1 || 'aef2'::text), ((tbl_pushdown.c3)::text || (tbl_pushdown.c9)::text), tbl_pushdown.c10, (tbl_pushdown.c5 + (tbl_pushdown.c6)::double precision)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..17.50 rows=1000 width=73)
         Output: (c1 || 'aef2'::text), ((c3)::text || (c9)::text), c10, (c5 + (c6)::double precision)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 50:
SELECT c1 || 'aef2', c3 || c9, c10, c5+c6 FROM tbl_pushdown GROUP BY 1, 2, 3, 4;
         ?column?         |                      ?column?                       | c10 |   ?column?   
--------------------------+-----------------------------------------------------+-----+--------------
 J%-2i30aef2              | <>?}|!@#$%^&*()_+0001-01-01 00:00:00                | f   | 123135.91231
 paintingsaef2            | มีวันที่ดี2000-01-01 00:00:00                            | t   |    -1877.121
 quantiryaef2             | ()ƯEFJAF3999-12-31 23:59:58                         | t   |      -210.12
 txid txidaef2            | <town>Toronto</town>2000-01-01 00:00:00             | t   |        -43.2
 naming it á ú í àaef2    | \\11321651316513161532004-10-19 10:23:54            | f   |      134.212
 格納用のドキュメントaef2 | ~!@#$!@#!@#@#2008-10-19 10:23:54                    | t   |    254.98394
 anything possibleaef2    | システム設計検討資料チャート作成2019-10-19 10:23:54 | t   |     555.7634
 030-1923=0aef2           | que tenga un lindo día2008-10-19 10:23:54           | f   |   9839874.12
 Sortaef2                 | Tjos os tres difficile2019-10-19 10:23:54           | f   |      1374.12
 MOẰNAJFKaef2             | interval2004-10-19 10:23:54                         | f   |     -12.1212
(10 rows)

--Testcase 51:
EXPLAIN VERBOSE SELECT c3 || c2, c4/c5+c6, c3 || c1 FROM tbl_pushdown GROUP BY 1, 2, 3;
                                                                                                                         QUERY PLAN                                                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=27.50..33.50 rows=200 width=72)
   Output: (((c3)::text || (c2)::text)), ((((c4)::double precision / c5) + (c6)::double precision)), (((c3)::text || c1))
   Group Key: ((tbl_pushdown.c3)::text || (tbl_pushdown.c2)::text), (((tbl_pushdown.c4)::double precision / tbl_pushdown.c5) + (tbl_pushdown.c6)::double precision), ((tbl_pushdown.c3)::text || tbl_pushdown.c1)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..20.00 rows=1000 width=72)
         Output: ((c3)::text || (c2)::text), (((c4)::double precision / c5) + (c6)::double precision), ((c3)::text || c1)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 52:
SELECT c3 || c2, c4/c5+c6, c3 || c1 FROM tbl_pushdown GROUP BY 1, 2, 3;
                   ?column?                    |      ?column?       |                     ?column?                      
-----------------------------------------------+---------------------+---------------------------------------------------
 <>?}|!@#$%^&*()_+akejf923!O@                  |   11.81219732571703 | <>?}|!@#$%^&*()_+J%-2i30
 Tjos os tres difficileJ#PR                    |   536.4682047859662 | Tjos os tres difficileSort
 intervalfat20 & ()\\                          | -190795.82838283828 | intervalMOẰNAJFK
 que tenga un lindo día~!@#$%^&*()_+           |  162.93318969986288 | que tenga un lindo día030-1923=0
 <town>Toronto</town>сковорода                 |   7.838345864661655 | <town>Toronto</town>txid txid
 \\1132165131651316153ごきげんよう             |  141.90831252229754 | \\1132165131651316153naming it á ú í à
 ~!@#$!@#!@#@#Đẹp trai                         |   19.02127630041976 | ~!@#$!@#!@#@#格納用のドキュメント
 มีวันที่ดี012803192                                |   48.76362583053657 | มีวันที่ดีpaintings
 システム設計検討資料チャート作成JFQO#@(JWAE)@ |   423.5871197963254 | システム設計検討資料チャート作成anything possible
 ()ƯEFJAFハンサム                              |   1.000565717518386 | ()ƯEFJAFquantiry
(10 rows)

--aggregate group by, where
--Testcase 53:
EXPLAIN VERBOSE SELECT c1 || 'aef', c2 || c3, c4/12, c5+21, 2*c6 FROM tbl_pushdown WHERE c6 > 0 GROUP BY 1, 2, 3, 4, 5;
                                                                                                                                                        QUERY PLAN                                                                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=27.50..32.50 rows=200 width=84)
   Output: ((c1 || 'aef'::text)), (((c2)::text || (c3)::text)), ((c4 / 12)), ((c5 + '21'::double precision)), ((2 * c6))
   Group Key: (tbl_pushdown.c1 || 'aef'::text), ((tbl_pushdown.c2)::text || (tbl_pushdown.c3)::text), (tbl_pushdown.c4 / 12), (tbl_pushdown.c5 + '21'::double precision), (2 * tbl_pushdown.c6)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..15.00 rows=1000 width=84)
         Output: (c1 || 'aef'::text), ((c2)::text || (c3)::text), (c4 / 12), (c5 + '21'::double precision), (2 * c6)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c6" : { "$gt" : { "$numberInt" : "0" } } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 54:
SELECT c1 || 'aef', c2 || c3, c4/12, c5+21, 2*c6 FROM tbl_pushdown WHERE c6 > 0 GROUP BY 1, 2, 3, 4, 5;
        ?column?         |                   ?column?                    | ?column? |   ?column?   | ?column? 
-------------------------+-----------------------------------------------+----------+--------------+----------
 Sortaef                 | J#PRTjos os tres difficile                    |      102 |       860.12 |     1070
 anything possibleaef    | JFQO#@(JWAE)@システム設計検討資料チャート作成 |     1951 |     253.7634 |      646
 J%-2i30aef              | akejf923!O@<>?}|!@#$%^&*()_+                  |    -1926 | 123144.91231 |       24
 paintingsaef            | 012803192มีวันที่ดี                                |      359 |    -1907.121 |      102
 格納用のドキュメントaef | Đẹp trai~!@#$!@#!@#@#                         |      -76 |    252.98394 |       46
 naming it á ú í àaef    | ごきげんよう\\1132165131651316153             |       17 |       32.212 |      246
 quantiryaef             | ハンサム()ƯEFJAF                              |       17 |      -191.12 |        4
 txid txidaef            | сковорода<town>Toronto</town>                 |        9 |        -32.2 |       20
 030-1923=0aef           | ~!@#$%^&*()_+que tenga un lindo día           |   765193 |   9839733.12 |      324
(9 rows)

--Testcase 55:
EXPLAIN VERBOSE SELECT c3 || c1, abs(c4/(c6-c5)), c9, c10 FROM tbl_pushdown WHERE c3 NOT IN ('/pgspider', '/postgres', '/svr') GROUP BY 1, 2, 3, 4;
                                                                                                                                                                               QUERY PLAN                                                                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=27.50..38.50 rows=400 width=49)
   Output: (((c3)::text || c1)), (abs(((c4)::double precision / ((c6)::double precision - c5)))), c9, c10
   Group Key: ((tbl_pushdown.c3)::text || tbl_pushdown.c1), abs(((tbl_pushdown.c4)::double precision / ((tbl_pushdown.c6)::double precision - tbl_pushdown.c5))), tbl_pushdown.c9, tbl_pushdown.c10
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..17.50 rows=1000 width=49)
         Output: ((c3)::text || c1), abs(((c4)::double precision / ((c6)::double precision - c5))), c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c3" : { "$nin" : [ "/pgspider", "/postgres", "/svr" ] } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 56:
SELECT c3 || c1, abs(c4/(c6-c5)), c9, c10 FROM tbl_pushdown WHERE c3 NOT IN ('/pgspider', '/postgres', '/svr') GROUP BY 1, 2, 3, 4;
                     ?column?                      |        abs         |         c9          | c10 
---------------------------------------------------+--------------------+---------------------+-----
 <town>Toronto</town>txid txid                     | 1.8196202531645569 | 2000-01-01 00:00:00 | t
 システム設計検討資料チャート作成anything possible | 259.46234676395164 | 2019-10-19 10:23:54 | t
 que tenga un lindo día030-1923=0                  | 0.9332050640542904 | 2008-10-19 10:23:54 | f
 ~!@#$!@#!@#@#格納用のドキュメント                 |  4.416607323988628 | 2008-10-19 10:23:54 | t
 <>?}|!@#$%^&*()_+J%-2i30                          | 0.1878209798396722 | 0001-01-01 00:00:00 | f
 Tjos os tres difficileSort                        |  4.051032487176115 | 2019-10-19 10:23:54 | f
 intervalMOẰNAJFK                                  | 1946.5770953294946 | 2004-10-19 10:23:54 | f
 ()ƯEFJAFquantiry                                  | 0.9900990099009901 | 3999-12-31 23:59:58 | t
 \\1132165131651316153naming it á ú í à            | 1.8964468458152932 | 2004-10-19 10:23:54 | f
 มีวันที่ดีpaintings                                    |  2.178745008516407 | 2000-01-01 00:00:00 | t
(10 rows)

--Testcase 57:
EXPLAIN VERBOSE SELECT c1, avg(c4-c5), sum(c6) FROM tbl_pushdown WHERE c4-c5 > c6 GROUP BY c1;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=12.50..15.00 rows=200 width=48)
   Output: c1, avg(((c4)::double precision - c5)), sum(c6)
   Group Key: tbl_pushdown.c1
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=52)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: (((tbl_pushdown.c4)::double precision - tbl_pushdown.c5) > (tbl_pushdown.c6)::double precision)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 58:
SELECT c1, avg(c4-c5), sum(c6) FROM tbl_pushdown WHERE c4-c5 > c6 GROUP BY c1;
        c1         |    avg     | sum 
-------------------+------------+-----
 MOẰNAJFK          | 23123.1212 | -12
 quantiry          |     424.12 |   2
 txid txid         |      168.2 |  10
 naming it á ú í à |    200.788 | 123
 anything possible | 23180.2366 | 323
 paintings         |   6240.121 |  51
(6 rows)

--Testcase 59:
EXPLAIN VERBOSE SELECT c7->'name', c7->>'key', c7->'events'->1, c7->'events'->>2, c7->'values'->>1 FROM tbl_pushdown WHERE (c7->'values'->>1)::float8 != 0 GROUP BY c7;
ERROR:  could not identify an equality operator for type json
LINE 1: ..._pushdown WHERE (c7->'values'->>1)::float8 != 0 GROUP BY c7;
                                                                    ^
--Testcase 60:
SELECT c7->'name', c7->>'key', c7->'events'->1, c7->'events'->>2, c7->'values'->>1 FROM tbl_pushdown WHERE (c7->'values'->>1)::float8 != 0 GROUP BY c7;
ERROR:  could not identify an equality operator for type json
LINE 1: ..._pushdown WHERE (c7->'values'->>1)::float8 != 0 GROUP BY c7;
                                                                    ^
--Testcase 61:
EXPLAIN VERBOSE SELECT c8->'teams'->'parent'->'name', c8->'teams'->'parent'->>'id' FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' IS NOT NULL GROUP BY c8;
                                                              QUERY PLAN                                                               
---------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=2.50..7.50 rows=200 width=96)
   Output: (((c8 -> 'teams'::text) -> 'parent'::text) -> 'name'::text), (((c8 -> 'teams'::text) -> 'parent'::text) ->> 'id'::text), c8
   Group Key: tbl_pushdown.c8
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=32)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: ((((tbl_pushdown.c8 -> 'teams'::text) -> 'parent'::text) ->> 'name'::text) IS NOT NULL)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c8" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 62:
SELECT c8->'teams'->'parent'->'name', c8->'teams'->'parent'->>'id' FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' IS NOT NULL GROUP BY c8;
       ?column?       | ?column? 
----------------------+----------
 "team1"              | 4534163
 "team1"              | 4534163
 "team3"              | 4538778
 "team1"              | 4534163
 "//_\\\\||team9;-\"" | 4579782
 "team1"              | 4534163
 "=-~@030-team8"      | 4534163
 "team1"              | 4534163
 "=-~@030-team8"      | 4534163
(9 rows)

--aggregate group by, having
--Testcase 63:
EXPLAIN VERBOSE SELECT c9, c4, c5, c6 FROM tbl_pushdown GROUP BY 1, 2, 3, 4 HAVING c4 <> 0;
                                                                                                                                                   QUERY PLAN                                                                                                                                                    
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=28)
   Output: c9, c4, c5, c6
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "c4" : { "$ne" : { "$numberInt" : "0" } } } }, { "$group" : { "_id" : { "ref0" : "$c9", "ref1" : "$c4", "ref2" : "$c5", "ref3" : "$c6" } } }, { "$project" : { "ref0" : "$_id.ref0", "ref1" : "$_id.ref1", "ref2" : "$_id.ref2", "ref3" : "$_id.ref3" } } ] }
(4 rows)

--Testcase 64:
SELECT * FROM (
SELECT c9, c4, c5, c6 FROM tbl_pushdown GROUP BY 1, 2, 3, 4 HAVING c4 <> 0
) t ORDER BY 1, 2, 3, 4;
         c9          |   c4    |      c5      | c6  
---------------------+---------+--------------+-----
 0001-01-01 00:00:00 |  -23123 | 123123.91231 |  12
 2000-01-01 00:00:00 |     115 |        -53.2 |  10
 2000-01-01 00:00:00 |    4312 |    -1928.121 |  51
 2004-10-19 10:23:54 |     212 |       11.212 | 123
 2004-10-19 10:23:54 |   23123 |      -0.1212 | -12
 2008-10-19 10:23:54 |    -923 |    231.98394 |  23
 2008-10-19 10:23:54 | 9182318 |   9839712.12 | 162
 2019-10-19 10:23:54 |    1232 |       839.12 | 535
 2019-10-19 10:23:54 |   23413 |     232.7634 | 323
 3999-12-31 23:59:58 |     212 |      -212.12 |   2
(10 rows)

--Testcase 65:
EXPLAIN VERBOSE SELECT stddev(c4), stddev_pop(c5), stddev_samp(c6) FROM tbl_pushdown GROUP BY c6 HAVING avg(c6) > 0;
                                                                                                                                                                                                                          QUERY PLAN                                                                                                                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=76)
   Output: (stddev(c4)), (stddev_pop(c5)), (stddev_samp(c6)), c6
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$group" : { "_id" : { "ref3" : "$c6" }, "ref0" : { "$stdDevSamp" : "$c4" }, "ref1" : { "$stdDevPop" : "$c5" }, "ref2" : { "$stdDevSamp" : "$c6" }, "ref4" : { "$avg" : "$c6" } } }, { "$match" : { "$expr" : { "$gt" : [ "$ref4", { "$numberDouble" : "0.0" } ] } } }, { "$project" : { "ref3" : "$_id.ref3", "ref0" : { "$numberInt" : "1" }, "ref1" : { "$numberInt" : "1" }, "ref2" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 66:
SELECT stddev(c4), stddev_pop(c5), stddev_samp(c6) FROM tbl_pushdown GROUP BY c6 HAVING avg(c6) > 0;
 stddev | stddev_pop | stddev_samp 
--------+------------+-------------
        |          0 |            
        |          0 |            
        |          0 |            
        |          0 |            
        |          0 |            
        |          0 |            
        |          0 |            
        |          0 |            
        |          0 |            
(9 rows)

--Testcase 67:
EXPLAIN VERBOSE SELECT count(*), count(c1)-1, avg(c6)+3, sum(c4/12) FROM tbl_pushdown GROUP BY c1 HAVING count(c1) > 0;
                                                                          QUERY PLAN                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=15.00..18.84 rows=67 width=112)
   Output: count(*), (count(c1) - 1), (avg(c6) + '3'::numeric), sum((c4 / 12)), c1
   Group Key: tbl_pushdown.c1
   Filter: (count(tbl_pushdown.c1) > 0)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=44)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 68:
SELECT count(*), count(c1)-1, avg(c6)+3, sum(c4/12) FROM tbl_pushdown GROUP BY c1 HAVING count(c1) > 0;
 count | ?column? |       ?column?       |  sum   
-------+----------+----------------------+--------
     1 |        0 |  -9.0000000000000000 |   1926
     1 |        0 | 165.0000000000000000 | 765193
     1 |        0 |   5.0000000000000000 |     17
     1 |        0 |  13.0000000000000000 |      9
     1 |        0 |  15.0000000000000000 |  -1926
     1 |        0 | 126.0000000000000000 |     17
     1 |        0 | 326.0000000000000000 |   1951
     1 |        0 |  26.0000000000000000 |    -76
     1 |        0 | 538.0000000000000000 |    102
     1 |        0 |  54.0000000000000000 |    359
(10 rows)

--Testcase 69:
EXPLAIN VERBOSE SELECT c1, c2 || c3, c10, c9 FROM tbl_pushdown GROUP BY c1, c2, c3, c4, c5, c6, c9, c10 HAVING c4+c5 > c6;
                                                                                                                                                        QUERY PLAN                                                                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=20.00..26.00 rows=400 width=1633)
   Output: c1, ((c2)::text || (c3)::text), c10, c9, c2, c3, c4, c5, c6
   Group Key: tbl_pushdown.c1, tbl_pushdown.c2, tbl_pushdown.c3, tbl_pushdown.c4, tbl_pushdown.c5, tbl_pushdown.c6, tbl_pushdown.c9, tbl_pushdown.c10
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1601)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: (((tbl_pushdown.c4)::double precision + tbl_pushdown.c5) > (tbl_pushdown.c6)::double precision)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 70:
SELECT c1, c2 || c3, c10, c9 FROM tbl_pushdown GROUP BY c1, c2, c3, c4, c5, c6, c9, c10 HAVING c4+c5 > c6;
        c1         |                   ?column?                    | c10 |         c9          
-------------------+-----------------------------------------------+-----+---------------------
 J%-2i30           | akejf923!O@<>?}|!@#$%^&*()_+                  | f   | 0001-01-01 00:00:00
 Sort              | J#PRTjos os tres difficile                    | f   | 2019-10-19 10:23:54
 MOẰNAJFK          | fat20 & ()\\interval                          | f   | 2004-10-19 10:23:54
 030-1923=0        | ~!@#$%^&*()_+que tenga un lindo día           | f   | 2008-10-19 10:23:54
 naming it á ú í à | ごきげんよう\\1132165131651316153             | f   | 2004-10-19 10:23:54
 anything possible | JFQO#@(JWAE)@システム設計検討資料チャート作成 | t   | 2019-10-19 10:23:54
 paintings         | 012803192มีวันที่ดี                                | t   | 2000-01-01 00:00:00
 txid txid         | сковорода<town>Toronto</town>                 | t   | 2000-01-01 00:00:00
(8 rows)

--aggregate group by, where, having
--Testcase 71:
EXPLAIN VERBOSE SELECT array_agg(c1 || ' ' || c2) FROM tbl_pushdown WHERE c2 != 'aes3r' GROUP BY c4 HAVING min(c4) <> 0;
                                                                                                  QUERY PLAN                                                                                                  
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=12.50..15.50 rows=199 width=40)
   Output: array_agg(((c1 || ' '::text) || (c2)::text)), c4
   Group Key: tbl_pushdown.c4
   Filter: (min(tbl_pushdown.c4) <> 0)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=556)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c2" : { "$ne" : "aes3r" } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 72:
SELECT array_agg(c1 || ' ' || c2) FROM tbl_pushdown WHERE c2 != 'aes3r' GROUP BY c4 HAVING min(c4) <> 0;
                       array_agg                        
--------------------------------------------------------
 {"txid txid сковорода"}
 {"anything possible JFQO#@(JWAE)@"}
 {"MOẰNAJFK fat20 & ()\\\\"}
 {"paintings 012803192"}
 {"quantiry ハンサム","naming it á ú í à ごきげんよう"}
 {"格納用のドキュメント Đẹp trai"}
 {"J%-2i30 akejf923!O@"}
 {"Sort J#PR"}
 {"030-1923=0 ~!@#$%^&*()_+"}
(9 rows)

--Testcase 73:
EXPLAIN VERBOSE SELECT string_agg(c2, ' '), string_agg(c1, ' ') FROM tbl_pushdown WHERE c1 != c2 HAVING max(c5) > 0;
                                                                                                QUERY PLAN                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=7.50..7.52 rows=1 width=64)
   Output: string_agg((c2)::text, ' '::text), string_agg(c1, ' '::text)
   Filter: (max(tbl_pushdown.c5) > '0'::double precision)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=556)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c1" : { "$ne" : null } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 74:
SELECT string_agg(c2, ' '), string_agg(c1, ' ') FROM tbl_pushdown WHERE c1 != c2 HAVING max(c5) > 0;
                                                  string_agg                                                  |                                                       string_agg                                                       
--------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------------------
 012803192 сковорода ハンサム ごきげんよう fat20 & ()\\ akejf923!O@ Đẹp trai ~!@#$%^&*()_+ JFQO#@(JWAE)@ J#PR | paintings txid txid quantiry naming it á ú í à MOẰNAJFK J%-2i30 格納用のドキュメント 030-1923=0 anything possible Sort
(1 row)

--Testcase 75:
EXPLAIN VERBOSE SELECT c9, c1, c3, sum(c6)+avg(c4)/2 FROM tbl_pushdown WHERE c1 IS NOT NULL GROUP BY c1, c2, c3, c9 HAVING c2 <> '#@O!';
                                                                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                                                                 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=1612)
   Output: c9, c1, c3, (((sum(c6)))::numeric + ((avg(c4)) / '2'::numeric)), c2
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "$and" : [ { "c1" : { "$ne" : null } }, { "c2" : { "$ne" : "#@O!" } } ] } }, { "$group" : { "_id" : { "ref0" : "$c9", "ref1" : "$c1", "ref2" : "$c3", "ref5" : "$c2" }, "ref3" : { "$sum" : "$c6" }, "ref4" : { "$avg" : "$c4" } } }, { "$project" : { "ref0" : "$_id.ref0", "ref1" : "$_id.ref1", "ref2" : "$_id.ref2", "ref5" : "$_id.ref5", "ref3" : { "$numberInt" : "1" }, "ref4" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 76:
SELECT * FROM (
SELECT c9, c1, c3, sum(c6)+avg(c4)/2 FROM tbl_pushdown WHERE c1 IS NOT NULL GROUP BY c1, c2, c3, c9 HAVING c2 <> '#@O!'
) t ORDER BY 1, 2, 3, 4;
         c9          |          c1          |                                                                                                                                       c3                                                                                                                                        |        ?column?         
---------------------+----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------
 0001-01-01 00:00:00 | J%-2i30              | <>?}|!@#$%^&*()_+                                                                                                                                                                                                                                                               | -11549.5000000000000000
 2000-01-01 00:00:00 | paintings            | มีวันที่ดี                                                                                                                                                                                                                                                                           |   2207.0000000000000000
 2000-01-01 00:00:00 | txid txid            | <town>Toronto</town>                                                                                                                                                                                                                                                            |     67.5000000000000000
 2004-10-19 10:23:54 | MOẰNAJFK             | interval                                                                                                                                                                                                                                                                        |  11549.5000000000000000
 2004-10-19 10:23:54 | naming it á ú í à    | \\1132165131651316153                                                                                                                                                                                                                                                           |    229.0000000000000000
 2008-10-19 10:23:54 | 030-1923=0           | que tenga un lindo día                                                                                                                                                                                                                                                          |    4591321.000000000000
 2008-10-19 10:23:54 | 格納用のドキュメント | ~!@#$!@#!@#@#                                                                                                                                                                                                                                                                   |   -438.5000000000000000
 2019-10-19 10:23:54 | anything possible    | システム設計検討資料チャート作成                                                                                                                                                                                                                                                |  12029.5000000000000000
 2019-10-19 10:23:54 | Sort                 | Tjos os tres difficile                                                                                                                                                                                                                                                          |   1151.0000000000000000
 3999-12-31 23:59:58 | quantiry             | ()ƯEFJAF                                                                                                                                                                                                                                                                        |    108.0000000000000000
(10 rows)

--Testcase 77:
EXPLAIN VERBOSE SELECT c4 <> 0, c5 < 0, stddev(c5) FROM tbl_pushdown WHERE c4 != 0 GROUP BY c4, c5 HAVING c5 <= c4; 
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=7.50..11.00 rows=200 width=26)
   Output: (c4 <> 0), (c5 < '0'::double precision), stddev(c5), c4, c5
   Group Key: tbl_pushdown.c4, tbl_pushdown.c5
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=16)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: (tbl_pushdown.c5 <= (tbl_pushdown.c4)::double precision)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c4" : { "$ne" : { "$numberInt" : "0" } } } }, { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 78:
SELECT c4 <> 0, c5 < 0, stddev(c5) FROM tbl_pushdown WHERE c4 != 0 GROUP BY c4, c5 HAVING c5 <= c4; 
 ?column? | ?column? | stddev 
----------+----------+--------
 t        | t        |       
 t        | t        |       
 t        | f        |       
 t        | f        |       
 t        | t        |       
 t        | f        |       
 t        | t        |       
(7 rows)

--Testcase 79:
EXPLAIN VERBOSE SELECT c8, c9, c10 FROM tbl_pushdown WHERE c4+c5 > c6*3 GROUP BY c4, c6, c8, c9, c10 HAVING c4 >= c6+23;
                                                                                                                         QUERY PLAN                                                                                                                          
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=12.50..16.50 rows=400 width=53)
   Output: c8, c9, c10, c4, c6
   Group Key: tbl_pushdown.c4, tbl_pushdown.c6, tbl_pushdown.c8, tbl_pushdown.c9, tbl_pushdown.c10
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=53)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: ((tbl_pushdown.c4 >= (tbl_pushdown.c6 + 23)) AND (((tbl_pushdown.c4)::double precision + tbl_pushdown.c5) > ((tbl_pushdown.c6 * 3))::double precision))
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c8" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 80:
SELECT c8, c9, c10 FROM tbl_pushdown WHERE c4+c5 > c6*3 GROUP BY c4, c6, c8, c9, c10 HAVING c4 >= c6+23;
                                                                               c8                                                                               |         c9          | c10 
----------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+-----
 {"teams": {"id": 4579782, "name": "team7", "parent": {"id": 4534163, "name": "team1"}, "node_id": "MDQ6VGVhbTQ1Nzk3ODI=", "privacy": "closed"}}                | 2000-01-01 00:00:00 | t
 {"teams": {"id": 2323, "name": "team6", "parent": {"id": 4534163, "name": "=-~@030-team8"}, "node_id": "構成済み=", "privacy": "closed"}}                      | 2019-10-19 10:23:54 | f
 {"teams": {"id": 23, "name": "team5", "parent": {"id": 4534163, "name": "team1"}, "node_id": "MDQ6VGVhbTQ1Nzk3ODI=", "privacy": "closed"}}                     | 2019-10-19 10:23:54 | t
 {"teams": {"id": 4579782, "name": "//_\\\\||team9;-\"", "parent": {"id": 4534163, "name": "team1"}, "node_id": "MDQ6VGVhbTQ1Nzk3ODI=", "privacy": "closed"}}   | 2000-01-01 00:00:00 | t
 {"teams": {"id": 34242, "name": "team4", "parent": {"id": 4534163, "name": "team1"}, "node_id": "7)(!!@!!#@$%^&=", "privacy": "closed"}}                       | 2008-10-19 10:23:54 | f
 {"teams": {"id": 4579783, "name": "team10", "parent": {"id": 4579782, "name": "//_\\\\||team9;-\""}, "node_id": "MDQ6VGVhbTQ1Nzk3ODM==", "privacy": "closed"}} | 2004-10-19 10:23:54 | f
(6 rows)

--limit only
--Testcase 81:
EXPLAIN VERBOSE SELECT avg(c4), stddev(c4), stddev_pop(c5), stddev_samp(c6) FROM tbl_pushdown LIMIT 1;
                                                                                                                                                                                                   QUERY PLAN                                                                                                                                                                                                   
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=0 width=104)
   Output: (avg(c4)), (stddev(c4)), (stddev_pop(c5)), (stddev_samp(c6))
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$group" : { "_id" : {  }, "ref0" : { "$avg" : "$c4" }, "ref1" : { "$stdDevSamp" : "$c4" }, "ref2" : { "$stdDevPop" : "$c5" }, "ref3" : { "$stdDevSamp" : "$c6" } } }, { "$project" : { "ref0" : { "$numberInt" : "1" }, "ref1" : { "$numberInt" : "1" }, "ref2" : { "$numberInt" : "1" }, "ref3" : { "$numberInt" : "1" } } }, { "$limit" : { "$numberLong" : "1"} } ] }
(4 rows)

--Testcase 82:
SELECT avg(c4), stddev(c4), stddev_pop(c5), stddev_samp(c6) FROM tbl_pushdown LIMIT 1;
   avg    |      stddev      |    stddev_pop     |   stddev_samp    
----------+------------------+-------------------+------------------
 921089.1 | 2902729.58002507 | 2948067.822460538 | 177.765419709359
(1 row)

--Testcase 83:
EXPLAIN VERBOSE SELECT c7->'name', c7->>'key', c7->'events'->1, c7->'events'->>2, c7->'values'->>1 FROM tbl_pushdown LIMIT 5;
                                                                     QUERY PLAN                                                                      
-----------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=160)
   Output: (c7 -> 'name'::text), (c7 ->> 'key'::text), ((c7 -> 'events'::text) -> 1), ((c7 -> 'events'::text) ->> 2), ((c7 -> 'values'::text) ->> 1)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c7" : { "$numberInt" : "1" } } }, { "$limit" : { "$numberLong" : "5"} } ] }
(4 rows)

--Testcase 84:
SELECT c7->'name', c7->>'key', c7->'events'->1, c7->'events'->>2, c7->'values'->>1 FROM tbl_pushdown LIMIT 5;
                   ?column?                    |   ?column?   |  ?column?   | ?column? |       ?column?        
-----------------------------------------------+--------------+-------------+----------+-----------------------
 "GNU General Public License v2.0"             | gpl-2.0      | "roll_back" | create   | 12.400000000000000355
 "Apache License 2.0"                          | apache-2.0   | "roll_back" | create   | 12.199999999999999289
 "BSD 2-Clause \"Simplified\" License"         | bsd-2-clause | "roll_back" | create   | 12.099999999999999645
 "BSD 3-Clause \"New\" or \"Revised\" License" | bsd-3-clause | "roll_back" | create   | 56.600000000000001421
 "Boost Software License 1.0"                  | bsl-1.0      | "roll_back" | create   | 656.20000000000004547
(5 rows)

--Testcase 85:
EXPLAIN VERBOSE SELECT c2 || c1, round(c4/(c6-c5)), c9 FROM tbl_pushdown LIMIT 5;
                                                                                                                                         QUERY PLAN                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=48)
   Output: ((c2)::text || c1), round(((c4)::double precision / ((c6)::double precision - c5))), c9
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" } } }, { "$limit" : { "$numberLong" : "5"} } ] }
(4 rows)

--Testcase 86:
SELECT c2 || c1, round(c4/(c6-c5)), c9 FROM tbl_pushdown LIMIT 5;
           ?column?            | round |         c9          
-------------------------------+-------+---------------------
 012803192paintings            |     2 | 2000-01-01 00:00:00
 сковородаtxid txid            |     2 | 2000-01-01 00:00:00
 ハンサムquantiry              |     1 | 3999-12-31 23:59:58
 ごきげんようnaming it á ú í à |     2 | 2004-10-19 10:23:54
 fat20 & ()\\MOẰNAJFK          | -1947 | 2004-10-19 10:23:54
(5 rows)

--Testcase 87:
EXPLAIN VERBOSE SELECT c1, c2, c3, c4, c5 FROM tbl_pushdown LIMIT 10;
                                                                                                                          QUERY PLAN                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=1588)
   Output: c1, c2, c3, c4, c5
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" } } }, { "$limit" : { "$numberLong" : "10"} } ] }
(4 rows)

--Testcase 88:
SELECT c1, c2, c3, c4, c5 FROM tbl_pushdown LIMIT 10;
          c1          |      c2       |                                                                                                                                       c3                                                                                                                                        |   c4    |      c5      
----------------------+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+--------------
 paintings            | 012803192     | มีวันที่ดี                                                                                                                                                                                                                                                                           |    4312 |    -1928.121
 txid txid            | сковорода     | <town>Toronto</town>                                                                                                                                                                                                                                                            |     115 |        -53.2
 quantiry             | ハンサム      | ()ƯEFJAF                                                                                                                                                                                                                                                                        |     212 |      -212.12
 naming it á ú í à    | ごきげんよう  | \\1132165131651316153                                                                                                                                                                                                                                                           |     212 |       11.212
 MOẰNAJFK             | fat20 & ()\\  | interval                                                                                                                                                                                                                                                                        |   23123 |      -0.1212
 J%-2i30              | akejf923!O@   | <>?}|!@#$%^&*()_+                                                                                                                                                                                                                                                               |  -23123 | 123123.91231
 格納用のドキュメント | Đẹp trai      | ~!@#$!@#!@#@#                                                                                                                                                                                                                                                                   |    -923 |    231.98394
 030-1923=0           | ~!@#$%^&*()_+ | que tenga un lindo día                                                                                                                                                                                                                                                          | 9182318 |   9839712.12
 anything possible    | JFQO#@(JWAE)@ | システム設計検討資料チャート作成                                                                                                                                                                                                                                                |   23413 |     232.7634
 Sort                 | J#PR          | Tjos os tres difficile                                                                                                                                                                                                                                                          |    1232 |       839.12
(10 rows)

--Testcase 89:
EXPLAIN VERBOSE SELECT stddev((c7->'values'->>1)::double precision), avg(c4-c5), sum(c6/2) FROM tbl_pushdown LIMIT 2;
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=25.00..25.01 rows=1 width=24)
   Output: (stddev((((c7 -> 'values'::text) ->> 1))::double precision)), (avg(((c4)::double precision - c5))), (sum((c6 / 2)))
   ->  Aggregate  (cost=25.00..25.01 rows=1 width=24)
         Output: stddev((((c7 -> 'values'::text) ->> 1))::double precision), avg(((c4)::double precision - c5)), sum((c6 / 2))
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=52)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c7" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 90:
SELECT stddev((c7->'values'->>1)::double precision), avg(c4-c5), sum(c6/2) FROM tbl_pushdown LIMIT 2;
       stddev       |        avg         | sum 
--------------------+--------------------+-----
 288.07039210522055 | -75106.65494499993 | 612
(1 row)

--limit, where
--Testcase 91:
EXPLAIN VERBOSE SELECT count(DISTINCT c5), avg(c4), sum(c6)/stddev(c5) FROM tbl_pushdown WHERE c4 NOT IN (12, 23132, -12390123) LIMIT 1;
                                                                                                                                             QUERY PLAN                                                                                                                                              
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=10.01..10.02 rows=1 width=48)
   Output: (count(DISTINCT c5)), (avg(c4)), (((sum(c6))::double precision / stddev(c5)))
   ->  Aggregate  (cost=10.01..10.02 rows=1 width=48)
         Output: count(DISTINCT c5), avg(c4), ((sum(c6))::double precision / stddev(c5))
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=20)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "c4" : { "$nin" : [ { "$numberLong" : "12"}, { "$numberLong" : "23132"}, { "$numberLong" : "-12390123"} ] } } }, { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 92:
SELECT count(DISTINCT c5), avg(c4), sum(c6)/stddev(c5) FROM tbl_pushdown WHERE c4 NOT IN (12, 23132, -12390123) LIMIT 1;
 count |         avg         |        ?column?        
-------+---------------------+------------------------
    10 | 921089.100000000000 | 0.00039549014592580266
(1 row)

--Testcase 93:
EXPLAIN VERBOSE SELECT 2, 23, c1 || '232AF', c4/2, c5+12, c6*12 FROM tbl_pushdown WHERE c4 NOT BETWEEN -100 AND 100 LIMIT 5;
                                                                                                                                                                           QUERY PLAN                                                                                                                                                                            
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=60)
   Output: 2, 23, (c1 || '232AF'::text), (c4 / 2), (c5 + '12'::double precision), (c6 * 12)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "$or" : [ { "c4" : { "$lt" : { "$numberInt" : "-100" } } }, { "c4" : { "$gt" : { "$numberInt" : "100" } } } ] } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } }, { "$limit" : { "$numberLong" : "5"} } ] }
(4 rows)

--Testcase 94:
SELECT 2, 23, c1 || '232AF', c4/2, c5+12, c6*12 FROM tbl_pushdown WHERE c4 NOT BETWEEN -100 AND 100 LIMIT 5;
 ?column? | ?column? |        ?column?        | ?column? | ?column?  | ?column? 
----------+----------+------------------------+----------+-----------+----------
        2 |       23 | paintings232AF         |     2156 | -1916.121 |      612
        2 |       23 | txid txid232AF         |       57 |     -41.2 |      120
        2 |       23 | quantiry232AF          |      106 |   -200.12 |       24
        2 |       23 | naming it á ú í à232AF |      106 |    23.212 |     1476
        2 |       23 | MOẰNAJFK232AF          |    11561 |   11.8788 |     -144
(5 rows)

--Testcase 95:
EXPLAIN VERBOSE SELECT 'a3r23', 23, 23.23, '!_@*!@*' FROM tbl_pushdown WHERE c5 IN (12.12, 132.21, 0.12, -53.2, 123123.91231) LIMIT 1;
                                                                                                                                                                             QUERY PLAN                                                                                                                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=100)
   Output: 'a3r23'::text, 23, 23.23, '!_@*!@*'::text
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "c5" : { "$in" : [ { "$numberDouble" : "12.119999999999999218" }, { "$numberDouble" : "132.21000000000000796" }, { "$numberDouble" : "0.11999999999999999556" }, { "$numberDouble" : "-53.200000000000002842" }, { "$numberDouble" : "123123.91230999999971" } ] } } }, { "$limit" : { "$numberLong" : "1"} } ] }
(4 rows)

--Testcase 96:
SELECT 'a3r23', 23, 23.23, '!_@*!@*' FROM tbl_pushdown WHERE c5 IN (12.12, 132.21, 0.12, -53.2, 123123.91231) LIMIT 1;
 ?column? | ?column? | ?column? | ?column? 
----------+----------+----------+----------
 a3r23    |       23 |    23.23 | !_@*!@*
(1 row)

--Testcase 97:
EXPLAIN VERBOSE SELECT c1, c3, c5, c7 FROM tbl_pushdown WHERE c1 IN ('paintings', 'MOẰNAJFK') LIMIT 0;
                                                                                                                                            QUERY PLAN                                                                                                                                            
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=1096)
   Output: c1, c3, c5, c7
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "c1" : { "$in" : [ "paintings", "MOẰNAJFK" ] } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c7" : { "$numberInt" : "1" } } }, { "$limit" : { "$numberLong" : "0"} } ] }
(4 rows)

--Testcase 98:
SELECT c1, c3, c5, c7 FROM tbl_pushdown WHERE c1 IN ('paintings', 'MOẰNAJFK') LIMIT 0;
 c1 | c3 | c5 | c7 
----+----+----+----
(0 rows)

--Testcase 99:
EXPLAIN VERBOSE SELECT c9 || '@#', c4 + c5/c6, c6, c10 FROM tbl_pushdown WHERE c4 > 0 LIMIT 5;
                                                                                                                                                         QUERY PLAN                                                                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=45)
   Output: ((c9)::text || '@#'::text), ((c4)::double precision + (c5 / (c6)::double precision)), c6, c10
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "c4" : { "$gt" : { "$numberInt" : "0" } } } }, { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } }, { "$limit" : { "$numberLong" : "5"} } ] }
(4 rows)

--Testcase 100:
SELECT c9 || '@#', c4 + c5/c6, c6, c10 FROM tbl_pushdown WHERE c4 > 0 LIMIT 5;
       ?column?        |     ?column?      | c6  | c10 
-----------------------+-------------------+-----+-----
 2000-01-01 00:00:00@# | 4274.193705882353 |  51 | t
 2000-01-01 00:00:00@# |            109.68 |  10 | t
 3999-12-31 23:59:58@# |            105.94 |   2 | t
 2004-10-19 10:23:54@# | 212.0911544715447 | 123 | f
 2004-10-19 10:23:54@# |        23123.0101 | -12 | f
(5 rows)

--limit, where, group by, having
--Testcase 101:
EXPLAIN VERBOSE SELECT array_agg(c3 || ' ' || c1), array_agg(c1 || ':' || c2), stddev_pop(c5), stddev_samp(c6) FROM tbl_pushdown WHERE c5 NOT IN (12.2, -1292.1212) GROUP BY c1 HAVING c1 IS NOT NULL LIMIT 3;
                                                                                                                                                                                                        QUERY PLAN                                                                                                                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=25.00..25.06 rows=3 width=136)
   Output: (array_agg((((c3)::text || ' '::text) || c1))), (array_agg(((c1 || ':'::text) || (c2)::text))), (stddev_pop(c5)), (stddev_samp(c6)), c1
   ->  HashAggregate  (cost=25.00..29.00 rows=200 width=136)
         Output: array_agg((((c3)::text || ' '::text) || c1)), array_agg(((c1 || ':'::text) || (c2)::text)), stddev_pop(c5), stddev_samp(c6), c1
         Group Key: tbl_pushdown.c1
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1584)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "$and" : [ { "c1" : { "$ne" : null } }, { "c5" : { "$nin" : [ { "$numberDouble" : "12.199999999999999289" }, { "$numberDouble" : "-1292.1212000000000444" } ] } } ] } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(9 rows)

--Testcase 102:
SELECT array_agg(c3 || ' ' || c1), array_agg(c1 || ':' || c2), stddev_pop(c5), stddev_samp(c6) FROM tbl_pushdown WHERE c5 NOT IN (12.2, -1292.1212) GROUP BY c1 HAVING c1 IS NOT NULL LIMIT 3;
                       array_agg                        |              array_agg              | stddev_pop | stddev_samp 
--------------------------------------------------------+-------------------------------------+------------+-------------
 {"システム設計検討資料チャート作成 anything possible"} | {"anything possible:JFQO#@(JWAE)@"} |          0 |            
 {"~!@#$!@#!@#@# 格納用のドキュメント"}                 | {"格納用のドキュメント:Đẹp trai"}   |          0 |            
 {"Tjos os tres difficile Sort"}                        | {Sort:J#PR}                         |          0 |            
(3 rows)

--Testcase 103:
EXPLAIN VERBOSE SELECT string_agg(c3, ' '), string_agg(c1, ' ') FROM tbl_pushdown WHERE c6 <= c5  GROUP BY c3 HAVING string_agg(c3, ' ' ORDER BY c3) != 'a3W' LIMIT 1;
                                                                                                QUERY PLAN                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=49.83..49.94 rows=1 width=1088)
   Output: (string_agg((c3)::text, ' '::text)), (string_agg(c1, ' '::text)), c3
   ->  GroupAggregate  (cost=49.83..71.33 rows=199 width=1088)
         Output: string_agg((c3)::text, ' '::text), string_agg(c1, ' '::text), c3
         Group Key: tbl_pushdown.c3
         Filter: (string_agg((tbl_pushdown.c3)::text, ' '::text ORDER BY ((tbl_pushdown.c3)::text)) <> 'a3W'::text)
         ->  Sort  (cost=49.83..52.33 rows=1000 width=1056)
               Output: c3, c1
               Sort Key: tbl_pushdown.c3
               ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1056)
                     Output: c3, c1
                     Filter: ((tbl_pushdown.c6)::double precision <= tbl_pushdown.c5)
                     Foreign Namespace: enhance_regress.tbl_pushdown
                     Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(14 rows)

--Testcase 104:
SELECT string_agg(c3, ' '), string_agg(c1, ' ') FROM tbl_pushdown WHERE c6 <= c5  GROUP BY c3 HAVING string_agg(c3, ' ' ORDER BY c3) != 'a3W' LIMIT 1;
  string_agg   |      string_agg      
---------------+----------------------
 ~!@#$!@#!@#@# | 格納用のドキュメント
(1 row)

--Testcase 105:
EXPLAIN VERBOSE SELECT string_agg(c3, ':' ORDER BY c3), string_agg(c1, ',' ORDER BY c1) FROM tbl_pushdown WHERE c4 >= -1212039 GROUP BY c5 HAVING max(c5) > 0 LIMIT 1;
                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=49.83..50.11 rows=1 width=72)
   Output: (string_agg((c3)::text, ':'::text ORDER BY ((c3)::text))), (string_agg(c1, ','::text ORDER BY c1)), c5
   ->  GroupAggregate  (cost=49.83..68.33 rows=67 width=72)
         Output: string_agg((c3)::text, ':'::text ORDER BY ((c3)::text)), string_agg(c1, ','::text ORDER BY c1), c5
         Group Key: tbl_pushdown.c5
         Filter: (max(tbl_pushdown.c5) > '0'::double precision)
         ->  Sort  (cost=49.83..52.33 rows=1000 width=1064)
               Output: c5, c3, c1
               Sort Key: tbl_pushdown.c5
               ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1064)
                     Output: c5, c3, c1
                     Foreign Namespace: enhance_regress.tbl_pushdown
                     Query document: { "pipeline" : [ { "$match" : { "c4" : { "$gte" : { "$numberInt" : "-1212039" } } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" } } } ] }
(13 rows)

--Testcase 106:
SELECT string_agg(c3, ':' ORDER BY c3), string_agg(c1, ',' ORDER BY c1) FROM tbl_pushdown WHERE c4 >= -1212039 GROUP BY c5 HAVING max(c5) > 0 LIMIT 1;
      string_agg       |    string_agg     
-----------------------+-------------------
 \\1132165131651316153 | naming it á ú í à
(1 row)

--Testcase 107:
EXPLAIN VERBOSE SELECT c8->'teams'->'parent'->>'name', c8->'teams'->'parent'->>'id' FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' IS NOT NULL GROUP BY c4, c8, c8->'teams'->'parent'->'name', c8->'teams'->'parent'->'id' HAVING c4 <> 0 LIMIT 5;
                                                                                                                                  QUERY PLAN                                                                                                                                  
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=25.00..25.20 rows=5 width=168)
   Output: ((((c8 -> 'teams'::text) -> 'parent'::text) ->> 'name'::text)), ((((c8 -> 'teams'::text) -> 'parent'::text) ->> 'id'::text)), c4, c8, ((((c8 -> 'teams'::text) -> 'parent'::text) -> 'name'::text)), ((((c8 -> 'teams'::text) -> 'parent'::text) -> 'id'::text))
   ->  HashAggregate  (cost=25.00..33.00 rows=200 width=168)
         Output: (((c8 -> 'teams'::text) -> 'parent'::text) ->> 'name'::text), (((c8 -> 'teams'::text) -> 'parent'::text) ->> 'id'::text), c4, c8, ((((c8 -> 'teams'::text) -> 'parent'::text) -> 'name'::text)), ((((c8 -> 'teams'::text) -> 'parent'::text) -> 'id'::text))
         Group Key: tbl_pushdown.c4, tbl_pushdown.c8, ((((tbl_pushdown.c8 -> 'teams'::text) -> 'parent'::text) -> 'name'::text)), ((((tbl_pushdown.c8 -> 'teams'::text) -> 'parent'::text) -> 'id'::text))
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..15.00 rows=1000 width=104)
               Output: c4, c8, ((((c8 -> 'teams'::text) -> 'parent'::text) -> 'name'::text)), ((((c8 -> 'teams'::text) -> 'parent'::text) -> 'id'::text))
               Filter: ((((tbl_pushdown.c8 -> 'teams'::text) -> 'parent'::text) ->> 'name'::text) IS NOT NULL)
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "c4" : { "$ne" : { "$numberInt" : "0" } } } }, { "$project" : { "ref0" : "$c4", "ref1" : "$c8", "ref2" : "$c8.teams.parent.name", "ref3" : "$c8.teams.parent.id" } } ] }
(10 rows)

--Testcase 108:
SELECT c8->'teams'->'parent'->>'name', c8->'teams'->'parent'->>'id' FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' IS NOT NULL GROUP BY c4, c8, c8->'teams'->'parent'->'name', c8->'teams'->'parent'->'id' HAVING c4 <> 0 LIMIT 5;
   ?column?    | ?column? 
---------------+----------
 team1         | 4534163
 team1         | 4534163
 team3         | 4538778
 team1         | 4534163
 =-~@030-team8 | 4534163
(5 rows)

--Testcase 109:
EXPLAIN VERBOSE SELECT c1, avg(c4-c5), sum(c6) FROM tbl_pushdown WHERE c4-c5 > c6 GROUP BY c1, c4, c5, c6 HAVING max(c6) <> avg(c4) + 12 LIMIT 5;
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=25.00..25.11 rows=5 width=68)
   Output: c1, (avg(((c4)::double precision - c5))), (sum(c6)), c4, c5, c6
   ->  HashAggregate  (cost=25.00..29.50 rows=199 width=68)
         Output: c1, avg(((c4)::double precision - c5)), sum(c6), c4, c5, c6
         Group Key: tbl_pushdown.c1, tbl_pushdown.c4, tbl_pushdown.c5, tbl_pushdown.c6
         Filter: ((max(tbl_pushdown.c6))::numeric <> (avg(tbl_pushdown.c4) + '12'::numeric))
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=52)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Filter: (((tbl_pushdown.c4)::double precision - tbl_pushdown.c5) > (tbl_pushdown.c6)::double precision)
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(11 rows)

--Testcase 110:
SELECT c1, avg(c4-c5), sum(c6) FROM tbl_pushdown WHERE c4-c5 > c6 GROUP BY c1, c4, c5, c6 HAVING max(c6) <> avg(c4) + 12 LIMIT 5;
        c1         |    avg     | sum 
-------------------+------------+-----
 paintings         |   6240.121 |  51
 txid txid         |      168.2 |  10
 anything possible | 23180.2366 | 323
 MOẰNAJFK          | 23123.1212 | -12
 naming it á ú í à |    200.788 | 123
(5 rows)

--offset only
--Testcase 111:
EXPLAIN VERBOSE SELECT c7, c3, c5, c9 FROM tbl_pushdown OFFSET 1;
                                                                                                          QUERY PLAN                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=1072)
   Output: c7, c3, c5, c9
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c3" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c7" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" } } }, { "$skip" : { "$numberLong" : "1"} } ] }
(4 rows)

--Testcase 112:
SELECT c7, c3, c5, c9 FROM tbl_pushdown OFFSET 1;
                                                                                                             c7                                                                                                             |                                                                                                                                       c3                                                                                                                                        |      c5      |         c9          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+---------------------
 { "key" : "apache-2.0", "name" : "Apache License 2.0", "spdx_id" : "Apache-2.0", "events" : [ "update", "roll_back", "create", "delete" ], "values" : [ 0.0, 12.199999999999999289, -23.0 ] }                              | <town>Toronto</town>                                                                                                                                                                                                                                                            |        -53.2 | 2000-01-01 00:00:00
 { "key" : "bsd-2-clause", "name" : "BSD 2-Clause \"Simplified\" License", "spdx_id" : "BSD-2-Clause", "events" : [ "update", "roll_back", "create", "delete" ], "values" : [ -313.0, 12.099999999999999645, -23.0 ] }      | ()ƯEFJAF                                                                                                                                                                                                                                                                        |      -212.12 | 3999-12-31 23:59:58
 { "key" : "bsd-3-clause", "name" : "BSD 3-Clause \"New\" or \"Revised\" License", "spdx_id" : "BSD-3-Clause", "events" : [ "update", "roll_back", "create", "delete" ], "values" : [ 2.0, 56.600000000000001421, -23.0 ] } | \\1132165131651316153                                                                                                                                                                                                                                                           |       11.212 | 2004-10-19 10:23:54
 { "key" : "bsl-1.0", "name" : "Boost Software License 1.0", "spdx_id" : "BSL-1.0", "events" : [ "update", "roll_back", "create", "delete" ], "values" : [ 4.0, 656.20000000000004547, -23.0 ] }                            | interval                                                                                                                                                                                                                                                                        |      -0.1212 | 2004-10-19 10:23:54
 { "key" : "cc0-1.0", "name" : "Creative Commons Zero v1.0 Universal", "spdx_id" : "CC0-1.0", "events" : [ "update", "roll_back", "create", "delete" ], "values" : [ 76.0, 767.29999999999995453, -23.0 ] }                 | <>?}|!@#$%^&*()_+                                                                                                                                                                                                                                                               | 123123.91231 | 0001-01-01 00:00:00
 { "key" : "epl-2.0", "name" : "Eclipse Public License 2.0", "spdx_id" : "EPL-2.0", "events" : [ "update", "roll_back", "create", "delete" ], "values" : [ 56.0, 12.300000000000000711, -23.0 ] }                           | ~!@#$!@#!@#@#                                                                                                                                                                                                                                                                   |    231.98394 | 2008-10-19 10:23:54
 { "key" : "mit", "name" : "MIT License", "spdx_id" : "MIT", "events" : [ "update", "roll_back", "create", "delete" ], "values" : [ 54.0, 323.24000000000000909, -23.0 ] }                                                  | que tenga un lindo día                                                                                                                                                                                                                                                          |   9839712.12 | 2008-10-19 10:23:54
 { "key" : "mpl-2.0", "name" : "Mozilla Public License 2.0", "spdx_id" : "MPL-2.0", "events" : [ "update", "roll_back", "create", "delete" ], "values" : [ 676.0, 232.32099999999999795, -23.0 ] }                          | システム設計検討資料チャート作成                                                                                                                                                                                                                                                |     232.7634 | 2019-10-19 10:23:54
 { "key" : "unlicense", "name" : "The Unlicense", "spdx_id" : "Unlicense", "events" : [ "update", "roll_back", "create", "delete" ], "values" : [ 978.0, 0.4000000000000000222, -23.0 ] }                                   | Tjos os tres difficile                                                                                                                                                                                                                                                          |       839.12 | 2019-10-19 10:23:54
(9 rows)

--Testcase 113:
EXPLAIN VERBOSE SELECT count(DISTINCT c5), avg(c4), count(c2), sum(c6) FROM tbl_pushdown OFFSET 0;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=10.00..10.01 rows=1 width=56)
   Output: count(DISTINCT c5), avg(c4), count(c2), sum(c6)
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=536)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c2" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(6 rows)

--Testcase 114:
SELECT count(DISTINCT c5), avg(c4), count(c2), sum(c6) FROM tbl_pushdown OFFSET 0;
 count |         avg         | count | sum  
-------+---------------------+-------+------
    10 | 921089.100000000000 |    10 | 1229
(1 row)

--Testcase 115:
EXPLAIN VERBOSE SELECT c1 || 'aef', c2 || c3, c4/12, c5+21, 2*c6 FROM tbl_pushdown OFFSET 3;
                                                                                                                                         QUERY PLAN                                                                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=84)
   Output: (c1 || 'aef'::text), ((c2)::text || (c3)::text), (c4 / 12), (c5 + '21'::double precision), (2 * c6)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } }, { "$skip" : { "$numberLong" : "3"} } ] }
(4 rows)

--Testcase 116:
SELECT c1 || 'aef', c2 || c3, c4/12, c5+21, 2*c6 FROM tbl_pushdown OFFSET 3;
        ?column?         |                   ?column?                    | ?column? |   ?column?   | ?column? 
-------------------------+-----------------------------------------------+----------+--------------+----------
 naming it á ú í àaef    | ごきげんよう\\1132165131651316153             |       17 |       32.212 |      246
 MOẰNAJFKaef             | fat20 & ()\\interval                          |     1926 |      20.8788 |      -24
 J%-2i30aef              | akejf923!O@<>?}|!@#$%^&*()_+                  |    -1926 | 123144.91231 |       24
 格納用のドキュメントaef | Đẹp trai~!@#$!@#!@#@#                         |      -76 |    252.98394 |       46
 030-1923=0aef           | ~!@#$%^&*()_+que tenga un lindo día           |   765193 |   9839733.12 |      324
 anything possibleaef    | JFQO#@(JWAE)@システム設計検討資料チャート作成 |     1951 |     253.7634 |      646
 Sortaef                 | J#PRTjos os tres difficile                    |      102 |       860.12 |     1070
(7 rows)

--Testcase 117:
EXPLAIN VERBOSE SELECT abs(c4/(c6-c5)), c3 || c9, c10, c5+c6 FROM tbl_pushdown OFFSET 1;
                                                                                                                                         QUERY PLAN                                                                                                                                          
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=49)
   Output: abs(((c4)::double precision / ((c6)::double precision - c5))), ((c3)::text || (c9)::text), c10, (c5 + (c6)::double precision)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } }, { "$skip" : { "$numberLong" : "1"} } ] }
(4 rows)

--Testcase 118:
SELECT abs(c4/(c6-c5)), c3 || c9, c10, c5+c6 FROM tbl_pushdown OFFSET 1;
        abs         |                      ?column?                       | c10 |   ?column?   
--------------------+-----------------------------------------------------+-----+--------------
 1.8196202531645569 | <town>Toronto</town>2000-01-01 00:00:00             | t   |        -43.2
 0.9900990099009901 | ()ƯEFJAF3999-12-31 23:59:58                         | t   |      -210.12
 1.8964468458152932 | \\11321651316513161532004-10-19 10:23:54            | f   |      134.212
 1946.5770953294946 | interval2004-10-19 10:23:54                         | f   |     -12.1212
 0.1878209798396722 | <>?}|!@#$%^&*()_+0001-01-01 00:00:00                | f   | 123135.91231
  4.416607323988628 | ~!@#$!@#!@#@#2008-10-19 10:23:54                    | t   |    254.98394
 0.9332050640542904 | que tenga un lindo día2008-10-19 10:23:54           | f   |   9839874.12
 259.46234676395164 | システム設計検討資料チャート作成2019-10-19 10:23:54 | t   |     555.7634
  4.051032487176115 | Tjos os tres difficile2019-10-19 10:23:54           | f   |      1374.12
(9 rows)

--offset, where
--Testcase 119:
EXPLAIN VERBOSE SELECT c3, c9, c4+c5, c4-c5, abs(c6) FROM tbl_pushdown WHERE abs(c4) > abs(c5) OFFSET 1;
                                                                                                         QUERY PLAN                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=0.01..12.50 rows=999 width=1052)
   Output: c3, c9, (((c4)::double precision + c5)), (((c4)::double precision - c5)), (abs(c6))
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..12.50 rows=1000 width=1052)
         Output: c3, c9, ((c4)::double precision + c5), ((c4)::double precision - c5), abs(c6)
         Filter: ((abs(tbl_pushdown.c4))::double precision > abs(tbl_pushdown.c5))
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 120:
SELECT c3, c9, c4+c5, c4-c5, abs(c6) FROM tbl_pushdown WHERE abs(c4) > abs(c5) OFFSET 1;
                                                                                                                                       c3                                                                                                                                        |         c9          |  ?column?  |  ?column?   | abs 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------+------------+-------------+-----
 <town>Toronto</town>                                                                                                                                                                                                                                                            | 2000-01-01 00:00:00 |       61.8 |       168.2 |  10
 \\1132165131651316153                                                                                                                                                                                                                                                           | 2004-10-19 10:23:54 |    223.212 |     200.788 | 123
 interval                                                                                                                                                                                                                                                                        | 2004-10-19 10:23:54 | 23122.8788 |  23123.1212 |  12
 ~!@#$!@#!@#@#                                                                                                                                                                                                                                                                   | 2008-10-19 10:23:54 | -691.01606 | -1154.98394 |  23
 システム設計検討資料チャート作成                                                                                                                                                                                                                                                | 2019-10-19 10:23:54 | 23645.7634 |  23180.2366 | 323
 Tjos os tres difficile                                                                                                                                                                                                                                                          | 2019-10-19 10:23:54 |    2071.12 |      392.88 | 535
(6 rows)

--Testcase 121:
EXPLAIN VERBOSE SELECT c1 || c2 || c3, c4+c5/c6, c6/c4*2, c7->'events', c8->'teams'->'parent' FROM tbl_pushdown WHERE c7->'events'->>1 = 'update' OFFSET 5;
                                                                                                                                                        QUERY PLAN                                                                                                                                                        
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=0.15..30.00 rows=995 width=112)
   Output: (((c1 || (c2)::text) || (c3)::text)), (((c4)::double precision + (c5 / (c6)::double precision))), (((c6 / c4) * 2)), ((c7 -> 'events'::text)), (((c8 -> 'teams'::text) -> 'parent'::text))
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..30.00 rows=1000 width=112)
         Output: ((c1 || (c2)::text) || (c3)::text), ((c4)::double precision + (c5 / (c6)::double precision)), ((c6 / c4) * 2), (c7 -> 'events'::text), ((c8 -> 'teams'::text) -> 'parent'::text)
         Filter: (((tbl_pushdown.c7 -> 'events'::text) ->> 1) = 'update'::text)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c7" : { "$numberInt" : "1" }, "c8" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 122:
SELECT c1 || c2 || c3, c4+c5/c6, c6/c4*2, c7->'events', c8->'teams'->'parent' FROM tbl_pushdown WHERE c7->'events'->>1 = 'update' OFFSET 5;
 ?column? | ?column? | ?column? | ?column? | ?column? 
----------+----------+----------+----------+----------
(0 rows)

--Testcase 123:
EXPLAIN VERBOSE SELECT c8->'teams'->'parent'->'name', c8->'teams'->'parent'->'id' FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' = 'team1' OFFSET 1;
                                                                     QUERY PLAN                                                                     
----------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=0.01..15.00 rows=999 width=64)
   Output: ((((c8 -> 'teams'::text) -> 'parent'::text) -> 'name'::text)), ((((c8 -> 'teams'::text) -> 'parent'::text) -> 'id'::text))
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..15.00 rows=1000 width=64)
         Output: ((((c8 -> 'teams'::text) -> 'parent'::text) -> 'name'::text)), ((((c8 -> 'teams'::text) -> 'parent'::text) -> 'id'::text))
         Filter: ((((tbl_pushdown.c8 -> 'teams'::text) -> 'parent'::text) ->> 'name'::text) = 'team1'::text)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "ref0" : "$c8.teams.parent.name", "ref1" : "$c8.teams.parent.id", "ref2" : "$c8" } } ] }
(7 rows)

--Testcase 124:
SELECT c8->'teams'->'parent'->'name', c8->'teams'->'parent'->'id' FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' = 'team1' OFFSET 1;
 ?column? | ?column? 
----------+----------
 "team1"  | 4534163
 "team1"  | 4534163
 "team1"  | 4534163
 "team1"  | 4534163
(4 rows)

--Testcase 125:
EXPLAIN VERBOSE SELECT c7->>'name', c7->>'key', c7->'events'->1, c7->'events'->>2, c7->'values'->>1 FROM tbl_pushdown WHERE c10 = true OFFSET 1;
                                                                           QUERY PLAN                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=0.02..20.00 rows=999 width=160)
   Output: ((c7 ->> 'name'::text)), ((c7 ->> 'key'::text)), (((c7 -> 'events'::text) -> 1)), (((c7 -> 'events'::text) ->> 2)), (((c7 -> 'values'::text) ->> 1))
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..20.00 rows=1000 width=160)
         Output: (c7 ->> 'name'::text), (c7 ->> 'key'::text), ((c7 -> 'events'::text) -> 1), ((c7 -> 'events'::text) ->> 2), ((c7 -> 'values'::text) ->> 1)
         Filter: tbl_pushdown.c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c7" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(7 rows)

--Testcase 126:
SELECT c7->>'name', c7->>'key', c7->'events'->1, c7->'events'->>2, c7->'values'->>1 FROM tbl_pushdown WHERE c10 = true OFFSET 1;
             ?column?              |   ?column?   |  ?column?   | ?column? |       ?column?        
-----------------------------------+--------------+-------------+----------+-----------------------
 Apache License 2.0                | apache-2.0   | "roll_back" | create   | 12.199999999999999289
 BSD 2-Clause "Simplified" License | bsd-2-clause | "roll_back" | create   | 12.099999999999999645
 Eclipse Public License 2.0        | epl-2.0      | "roll_back" | create   | 12.300000000000000711
 Mozilla Public License 2.0        | mpl-2.0      | "roll_back" | create   | 232.32099999999999795
(4 rows)

--offset, where, group by, having
--Testcase 127:
EXPLAIN VERBOSE SELECT c10, c6+c5-c4, c3 || ' AND ' || c1 FROM tbl_pushdown WHERE c10 != false GROUP BY c1, c3, c4, c5, c6, c10 HAVING c1 IS NOT NULL OFFSET 1;
                                                                                                                                                  QUERY PLAN                                                                                                                                                   
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=15.03..26.00 rows=399 width=1117)
   Output: c10, ((((c6)::double precision + c5) - (c4)::double precision)), ((((c3)::text || ' AND '::text) || c1)), c1, c3, c4, c5, c6
   ->  HashAggregate  (cost=15.00..26.00 rows=400 width=1117)
         Output: c10, (((c6)::double precision + c5) - (c4)::double precision), (((c3)::text || ' AND '::text) || c1), c1, c3, c4, c5, c6
         Group Key: tbl_pushdown.c1, tbl_pushdown.c3, tbl_pushdown.c4, tbl_pushdown.c5, tbl_pushdown.c6, tbl_pushdown.c10
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1077)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Filter: tbl_pushdown.c10
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "c1" : { "$ne" : null } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(10 rows)

--Testcase 128:
SELECT c10, c6+c5-c4, c3 || ' AND ' || c1 FROM tbl_pushdown WHERE c10 != false GROUP BY c1, c3, c4, c5, c6, c10 HAVING c1 IS NOT NULL OFFSET 1;
 c10 |  ?column?  |                ?column?                
-----+------------+----------------------------------------
 t   |  -6189.121 | มีวันที่ดี AND paintings
 t   | 1177.98394 | ~!@#$!@#!@#@# AND 格納用のドキュメント
 t   |    -422.12 | ()ƯEFJAF AND quantiry
 t   |     -158.2 | <town>Toronto</town> AND txid txid
(4 rows)

--Testcase 129:
EXPLAIN VERBOSE SELECT c3, c2, c5+c6/c4, c5+12, c6*10 FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' = 'team1' GROUP BY c2, c3, c4, c5, c6 HAVING c5 NOT IN (12.12, 132.21, 0.12, -53.2) OFFSET 1;
                                                                                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                                                                                 
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=12.52..17.00 rows=199 width=1580)
   Output: c3, c2, ((c5 + ((c6 / c4))::double precision)), ((c5 + '12'::double precision)), ((c6 * 10)), c4, c5, c6
   ->  HashAggregate  (cost=12.50..17.00 rows=200 width=1580)
         Output: c3, c2, (c5 + ((c6 / c4))::double precision), (c5 + '12'::double precision), (c6 * 10), c4, c5, c6
         Group Key: tbl_pushdown.c2, tbl_pushdown.c3, tbl_pushdown.c4, tbl_pushdown.c5, tbl_pushdown.c6
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1560)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Filter: ((((tbl_pushdown.c8 -> 'teams'::text) -> 'parent'::text) ->> 'name'::text) = 'team1'::text)
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "c5" : { "$nin" : [ { "$numberDouble" : "12.119999999999999218" }, { "$numberDouble" : "132.21000000000000796" }, { "$numberDouble" : "0.11999999999999999556" }, { "$numberDouble" : "-53.200000000000002842" } ] } } }, { "$project" : { "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c8" : { "$numberInt" : "1" } } } ] }
(10 rows)

--Testcase 130:
SELECT c3, c2, c5+c6/c4, c5+12, c6*10 FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' = 'team1' GROUP BY c2, c3, c4, c5, c6 HAVING c5 NOT IN (12.12, 132.21, 0.12, -53.2) OFFSET 1;
                                                                                                                                       c3                                                                                                                                        |      c2       |   ?column?   |   ?column?   | ?column? 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+--------------+--------------+----------
 มีวันที่ดี                                                                                                                                                                                                                                                                           | 012803192     |    -1928.121 |    -1916.121 |      510
 <>?}|!@#$%^&*()_+                                                                                                                                                                                                                                                               | akejf923!O@   | 123123.91231 | 123135.91231 |      120
 システム設計検討資料チャート作成                                                                                                                                                                                                                                                | JFQO#@(JWAE)@ |     232.7634 |     244.7634 |     3230
(3 rows)

--Testcase 131:
EXPLAIN VERBOSE SELECT count(c5), avg(c4), c2, c9, c10 FROM tbl_pushdown WHERE NOT c10 = false GROUP BY c2, c9, c10 HAVING c2 IN ('012803192', 'ハンサム', 'ごきげんよう', '~!@#$%^&*()_+') OFFSET 1;
                                                                                                                                                               QUERY PLAN                                                                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=12.51..17.50 rows=399 width=565)
   Output: (count(c5)), (avg(c4)), c2, c9, c10
   ->  HashAggregate  (cost=12.50..17.50 rows=400 width=565)
         Output: count(c5), avg(c4), c2, c9, c10
         Group Key: tbl_pushdown.c2, tbl_pushdown.c9, tbl_pushdown.c10
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=541)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Filter: tbl_pushdown.c10
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "c2" : { "$in" : [ "012803192", "ハンサム", "ごきげんよう", "~!@#$%^&*()_+" ] } } }, { "$project" : { "c2" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(10 rows)

--Testcase 132:
SELECT count(c5), avg(c4), c2, c9, c10 FROM tbl_pushdown WHERE NOT c10 = false GROUP BY c2, c9, c10 HAVING c2 IN ('012803192', 'ハンサム', 'ごきげんよう', '~!@#$%^&*()_+') OFFSET 1;
 count |         avg          |    c2    |         c9          | c10 
-------+----------------------+----------+---------------------+-----
     1 | 212.0000000000000000 | ハンサム | 3999-12-31 23:59:58 | t
(1 row)

--Testcase 133:
EXPLAIN VERBOSE SELECT c9 || '@#', c4 + c5/c6, c6, c10 FROM tbl_pushdown WHERE c2 IN ('012803192', 'ハンサム', 'ごきげんよう', '~!@#$%^&*()_+') GROUP BY 1, 2, 3, 4 HAVING NOT c10 = false OFFSET 1;
                                                                                                                                                               QUERY PLAN                                                                                                                                                               
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=27.53..38.50 rows=399 width=45)
   Output: (((c9)::text || '@#'::text)), (((c4)::double precision + (c5 / (c6)::double precision))), c6, c10
   ->  HashAggregate  (cost=27.50..38.50 rows=400 width=45)
         Output: (((c9)::text || '@#'::text)), (((c4)::double precision + (c5 / (c6)::double precision))), c6, c10
         Group Key: ((tbl_pushdown.c9)::text || '@#'::text), ((tbl_pushdown.c4)::double precision + (tbl_pushdown.c5 / (tbl_pushdown.c6)::double precision)), tbl_pushdown.c6, tbl_pushdown.c10
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..17.50 rows=1000 width=45)
               Output: ((c9)::text || '@#'::text), ((c4)::double precision + (c5 / (c6)::double precision)), c6, c10
               Filter: tbl_pushdown.c10
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "c2" : { "$in" : [ "012803192", "ハンサム", "ごきげんよう", "~!@#$%^&*()_+" ] } } }, { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(10 rows)

--Testcase 134:
SELECT c9 || '@#', c4 + c5/c6, c6, c10 FROM tbl_pushdown WHERE c2 IN ('012803192', 'ハンサム', 'ごきげんよう', '~!@#$%^&*()_+') GROUP BY 1, 2, 3, 4 HAVING NOT c10 = false OFFSET 1;
       ?column?        |     ?column?      | c6 | c10 
-----------------------+-------------------+----+-----
 2000-01-01 00:00:00@# | 4274.193705882353 | 51 | t
(1 row)

--Testcase 135:
EXPLAIN VERBOSE SELECT _id, c1, c3, sum(c6)+avg(c4)/2 FROM tbl_pushdown WHERE c1 IS NOT NULL GROUP BY _id, c1, c2, c3, c9 HAVING c2 <> '#@O!' ORDER BY 1, 2 OFFSET 1;
                                                                                                                                                                                                                                                          QUERY PLAN                                                                                                                                                                                                                                                          
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=0.02..0.02 rows=1 width=1616)
   Output: _id, c1, c3, ((((sum(c6)))::numeric + ((avg(c4)) / '2'::numeric))), c2, c9
   ->  Sort  (cost=0.01..0.02 rows=1 width=1616)
         Output: _id, c1, c3, ((((sum(c6)))::numeric + ((avg(c4)) / '2'::numeric))), c2, c9
         Sort Key: tbl_pushdown._id, tbl_pushdown.c1
         ->  Foreign Scan  (cost=0.00..0.00 rows=1 width=1616)
               Output: _id, c1, c3, (((sum(c6)))::numeric + ((avg(c4)) / '2'::numeric)), c2, c9
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "$and" : [ { "c1" : { "$ne" : null } }, { "c2" : { "$ne" : "#@O!" } } ] } }, { "$group" : { "_id" : { "ref0" : "$_id", "ref1" : "$c1", "ref2" : "$c3", "ref5" : "$c2", "ref6" : "$c9" }, "ref3" : { "$sum" : "$c6" }, "ref4" : { "$avg" : "$c4" } } }, { "$project" : { "ref0" : "$_id.ref0", "ref1" : "$_id.ref1", "ref2" : "$_id.ref2", "ref5" : "$_id.ref5", "ref6" : "$_id.ref6", "ref3" : { "$numberInt" : "1" }, "ref4" : { "$numberInt" : "1" } } } ] }
(9 rows)

--Testcase 136:
SELECT * FROM (
SELECT _id, c1, c3, sum(c6)+avg(c4)/2 FROM tbl_pushdown WHERE c1 IS NOT NULL GROUP BY _id, c1, c2, c3, c9 HAVING c2 <> '#@O!' ORDER BY 1, 2 OFFSET 1
) t ORDER BY 1, 2, 3, 4;
 _id |          c1          |                                                                                                                                       c3                                                                                                                                        |        ?column?         
-----+----------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------
   2 | txid txid            | <town>Toronto</town>                                                                                                                                                                                                                                                            |     67.5000000000000000
   3 | quantiry             | ()ƯEFJAF                                                                                                                                                                                                                                                                        |    108.0000000000000000
   4 | naming it á ú í à    | \\1132165131651316153                                                                                                                                                                                                                                                           |    229.0000000000000000
   5 | MOẰNAJFK             | interval                                                                                                                                                                                                                                                                        |  11549.5000000000000000
   6 | J%-2i30              | <>?}|!@#$%^&*()_+                                                                                                                                                                                                                                                               | -11549.5000000000000000
   7 | 格納用のドキュメント | ~!@#$!@#!@#@#                                                                                                                                                                                                                                                                   |   -438.5000000000000000
   8 | 030-1923=0           | que tenga un lindo día                                                                                                                                                                                                                                                          |    4591321.000000000000
   9 | anything possible    | システム設計検討資料チャート作成                                                                                                                                                                                                                                                |  12029.5000000000000000
  10 | Sort                 | Tjos os tres difficile                                                                                                                                                                                                                                                          |   1151.0000000000000000
(9 rows)

--both limit, offset
--Testcase 137:
EXPLAIN VERBOSE SELECT c7->>'key', c7->>'values', c7->>'events' FROM tbl_pushdown LIMIT 10 OFFSET NULL;
                                                            QUERY PLAN                                                             
-----------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=96)
   Output: (c7 ->> 'key'::text), (c7 ->> 'values'::text), (c7 ->> 'events'::text)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c7" : { "$numberInt" : "1" } } }, { "$limit" : { "$numberLong" : "10"} } ] }
(4 rows)

--Testcase 138:
SELECT c7->>'key', c7->>'values', c7->>'events' FROM tbl_pushdown LIMIT 10 OFFSET NULL;
   ?column?   |                 ?column?                 |                   ?column?                    
--------------+------------------------------------------+-----------------------------------------------
 gpl-2.0      | [ 68.0, 12.400000000000000355, -23.0 ]   | [ "update", "roll_back", "create", "delete" ]
 apache-2.0   | [ 0.0, 12.199999999999999289, -23.0 ]    | [ "update", "roll_back", "create", "delete" ]
 bsd-2-clause | [ -313.0, 12.099999999999999645, -23.0 ] | [ "update", "roll_back", "create", "delete" ]
 bsd-3-clause | [ 2.0, 56.600000000000001421, -23.0 ]    | [ "update", "roll_back", "create", "delete" ]
 bsl-1.0      | [ 4.0, 656.20000000000004547, -23.0 ]    | [ "update", "roll_back", "create", "delete" ]
 cc0-1.0      | [ 76.0, 767.29999999999995453, -23.0 ]   | [ "update", "roll_back", "create", "delete" ]
 epl-2.0      | [ 56.0, 12.300000000000000711, -23.0 ]   | [ "update", "roll_back", "create", "delete" ]
 mit          | [ 54.0, 323.24000000000000909, -23.0 ]   | [ "update", "roll_back", "create", "delete" ]
 mpl-2.0      | [ 676.0, 232.32099999999999795, -23.0 ]  | [ "update", "roll_back", "create", "delete" ]
 unlicense    | [ 978.0, 0.4000000000000000222, -23.0 ]  | [ "update", "roll_back", "create", "delete" ]
(10 rows)

--Testcase 139:
EXPLAIN VERBOSE SELECT c8->'teams'->>'name', c8->'teams'->>'id', c8->'teams'->'privacy' FROM tbl_pushdown LIMIT ALL OFFSET 5;
                                                               QUERY PLAN                                                               
----------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=96)
   Output: ((c8 -> 'teams'::text) ->> 'name'::text), ((c8 -> 'teams'::text) ->> 'id'::text), ((c8 -> 'teams'::text) -> 'privacy'::text)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c8" : { "$numberInt" : "1" } } }, { "$skip" : { "$numberLong" : "5"} } ] }
(4 rows)

--Testcase 140:
SELECT c8->'teams'->>'name', c8->'teams'->>'id', c8->'teams'->'privacy' FROM tbl_pushdown LIMIT ALL OFFSET 5;
 ?column? | ?column? | ?column? 
----------+----------+----------
 team2    | 234234   | "secret"
 team3    | 355      | "closed"
 team4    | 34242    | "closed"
 team5    | 23       | "closed"
 team6    | 2323     | "closed"
(5 rows)

--Testcase 141:
EXPLAIN VERBOSE SELECT c7->'events'->>1, c7->'events'->>2, c7->'events'->>3, c7->'events'->>4 FROM tbl_pushdown LIMIT NULL OFFSET 1;
                                                                QUERY PLAN                                                                
------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=128)
   Output: ((c7 -> 'events'::text) ->> 1), ((c7 -> 'events'::text) ->> 2), ((c7 -> 'events'::text) ->> 3), ((c7 -> 'events'::text) ->> 4)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c7" : { "$numberInt" : "1" } } }, { "$skip" : { "$numberLong" : "1"} } ] }
(4 rows)

--Testcase 142:
SELECT c7->'events'->>1, c7->'events'->>2, c7->'events'->>3, c7->'events'->>4 FROM tbl_pushdown LIMIT NULL OFFSET 1;
 ?column?  | ?column? | ?column? | ?column? 
-----------+----------+----------+----------
 roll_back | create   | delete   | 
 roll_back | create   | delete   | 
 roll_back | create   | delete   | 
 roll_back | create   | delete   | 
 roll_back | create   | delete   | 
 roll_back | create   | delete   | 
 roll_back | create   | delete   | 
 roll_back | create   | delete   | 
 roll_back | create   | delete   | 
(9 rows)

--Testcase 143:
EXPLAIN VERBOSE SELECT c4 <> 0, c5 <= 0, (c7->'values'->>1)::float8 >= 0, (c7->'values'->>2)::double precision <> 0 FROM tbl_pushdown LIMIT 5 OFFSET 2;
                                                                                                              QUERY PLAN                                                                                                              
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=4)
   Output: (c4 <> 0), (c5 <= '0'::double precision), ((((c7 -> 'values'::text) ->> 1))::double precision >= '0'::double precision), ((((c7 -> 'values'::text) ->> 2))::double precision <> '0'::double precision)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c7" : { "$numberInt" : "1" } } }, { "$skip" : { "$numberLong" : "2"} }, { "$limit" : { "$numberLong" : "5"} } ] }
(4 rows)

--Testcase 144:
SELECT c4 <> 0, c5 <= 0, (c7->'values'->>1)::float8 >= 0, (c7->'values'->>2)::double precision <> 0 FROM tbl_pushdown LIMIT 5 OFFSET 2;
 ?column? | ?column? | ?column? | ?column? 
----------+----------+----------+----------
 t        | t        | t        | t
 t        | f        | t        | t
 t        | t        | t        | t
 t        | f        | t        | t
 t        | f        | t        | t
(5 rows)

--Testcase 145:
EXPLAIN VERBOSE SELECT 'a3r23', 23, 23.23, '!_@*!@*' FROM tbl_pushdown LIMIT 3 OFFSET 1;
                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=100)
   Output: 'a3r23'::text, 23, 23.23, '!_@*!@*'::text
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$skip" : { "$numberLong" : "1"} }, { "$limit" : { "$numberLong" : "3"} } ] }
(4 rows)

--Testcase 146:
SELECT 'a3r23', 23, 23.23, '!_@*!@*' FROM tbl_pushdown LIMIT 3 OFFSET 1;
 ?column? | ?column? | ?column? | ?column? 
----------+----------+----------+----------
 a3r23    |       23 |    23.23 | !_@*!@*
 a3r23    |       23 |    23.23 | !_@*!@*
 a3r23    |       23 |    23.23 | !_@*!@*
(3 rows)

--Testcase 147:
EXPLAIN VERBOSE SELECT stddev((c7->'values'->>2)::float8), avg(c4-c5), sum(c6/2) FROM tbl_pushdown LIMIT 2 OFFSET 0;
                                                                                             QUERY PLAN                                                                                             
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=25.00..25.01 rows=1 width=24)
   Output: (stddev((((c7 -> 'values'::text) ->> 2))::double precision)), (avg(((c4)::double precision - c5))), (sum((c6 / 2)))
   ->  Aggregate  (cost=25.00..25.01 rows=1 width=24)
         Output: stddev((((c7 -> 'values'::text) ->> 2))::double precision), avg(((c4)::double precision - c5)), sum((c6 / 2))
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=52)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c7" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 148:
SELECT stddev((c7->'values'->>2)::float8), avg(c4-c5), sum(c6/2) FROM tbl_pushdown LIMIT 2 OFFSET 0;
 stddev |        avg         | sum 
--------+--------------------+-----
      0 | -75106.65494499993 | 612
(1 row)

--Testcase 149:
EXPLAIN VERBOSE SELECT c7#>'{events,1}',c7#>>'{events,1}', c7#>'{events,2}', c7#>>'{events,2}', c7->'events' FROM tbl_pushdown LIMIT 5 OFFSET 1;
                                                                               QUERY PLAN                                                                               
------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=0 width=160)
   Output: (c7 #> '{events,1}'::text[]), (c7 #>> '{events,1}'::text[]), (c7 #> '{events,2}'::text[]), (c7 #>> '{events,2}'::text[]), (c7 -> 'events'::text)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c7" : { "$numberInt" : "1" } } }, { "$skip" : { "$numberLong" : "1"} }, { "$limit" : { "$numberLong" : "5"} } ] }
(4 rows)

--Testcase 150:
SELECT c7#>'{events,1}',c7#>>'{events,1}', c7#>'{events,2}', c7#>>'{events,2}', c7->'events' FROM tbl_pushdown LIMIT 5 OFFSET 1;
  ?column?   | ?column?  | ?column? | ?column? |                   ?column?                    
-------------+-----------+----------+----------+-----------------------------------------------
 "roll_back" | roll_back | "create" | create   | [ "update", "roll_back", "create", "delete" ]
 "roll_back" | roll_back | "create" | create   | [ "update", "roll_back", "create", "delete" ]
 "roll_back" | roll_back | "create" | create   | [ "update", "roll_back", "create", "delete" ]
 "roll_back" | roll_back | "create" | create   | [ "update", "roll_back", "create", "delete" ]
 "roll_back" | roll_back | "create" | create   | [ "update", "roll_back", "create", "delete" ]
(5 rows)

--limit, offset, where, group by, having
--Testcase 151:
EXPLAIN VERBOSE SELECT count(c1 || c3), c4, c6 FROM tbl_pushdown WHERE c4-c5 <> 0 GROUP BY c4, c5, c6 HAVING c6 NOT IN (1212, 23, -143, -124) LIMIT 5 OFFSET NULL; 
                                                                                                                                                                                       QUERY PLAN                                                                                                                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=15.00..15.05 rows=5 width=28)
   Output: (count((c1 || (c3)::text))), c4, c6, c5
   ->  HashAggregate  (cost=15.00..17.00 rows=200 width=28)
         Output: count((c1 || (c3)::text)), c4, c6, c5
         Group Key: tbl_pushdown.c4, tbl_pushdown.c5, tbl_pushdown.c6
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1076)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Filter: (((tbl_pushdown.c4)::double precision - tbl_pushdown.c5) <> '0'::double precision)
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "c6" : { "$nin" : [ { "$numberInt" : "1212" }, { "$numberInt" : "23" }, { "$numberInt" : "-143" }, { "$numberInt" : "-124" } ] } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(10 rows)

--Testcase 152:
SELECT count(c1 || c3), c4, c6 FROM tbl_pushdown WHERE c4-c5 <> 0 GROUP BY c4, c5, c6 HAVING c6 NOT IN (1212, 23, -143, -124) LIMIT 5 OFFSET NULL; 
 count |   c4   | c6  
-------+--------+-----
     1 |   4312 |  51
     1 |    115 |  10
     1 |   1232 | 535
     1 |  23413 | 323
     1 | -23123 |  12
(5 rows)

--Testcase 153:
EXPLAIN VERBOSE SELECT c3 || c1, abs(c4/(c6-c5)), c9, c10 FROM tbl_pushdown WHERE c3 NOT IN ('/eew', '/3434', '/svr') GROUP BY c1, c3, c4, c9, c10, c6, c5 HAVING c4 != 0 LIMIT ALL OFFSET NULL;
                                                                                                                                                                                                                                                QUERY PLAN                                                                                                                                                                                                                                                
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan  (cost=0.00..0.00 rows=1 width=1125)
   Output: ((c3)::text || c1), abs(((c4)::double precision / ((c6)::double precision - c5))), c9, c10, c1, c3, c4, c6, c5
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "$and" : [ { "c3" : { "$nin" : [ "/eew", "/3434", "/svr" ] } }, { "c4" : { "$ne" : { "$numberInt" : "0" } } } ] } }, { "$group" : { "_id" : { "ref0" : "$c9", "ref1" : "$c10", "ref2" : "$c1", "ref3" : "$c3", "ref4" : "$c4", "ref5" : "$c6", "ref6" : "$c5" } } }, { "$project" : { "ref0" : "$_id.ref0", "ref1" : "$_id.ref1", "ref2" : "$_id.ref2", "ref3" : "$_id.ref3", "ref4" : "$_id.ref4", "ref5" : "$_id.ref5", "ref6" : "$_id.ref6" } } ] }
(4 rows)

--Testcase 154:
SELECT * FROM (
SELECT c3 || c1, abs(c4/(c6-c5)), c9, c10 FROM tbl_pushdown WHERE c3 NOT IN ('/eew', '/3434', '/svr') GROUP BY c1, c3, c4, c9, c10, c6, c5 HAVING c4 != 0 LIMIT ALL OFFSET NULL
) t ORDER BY 1, 2, 3, 4;
                     ?column?                      |        abs         |         c9          | c10 
---------------------------------------------------+--------------------+---------------------+-----
 \\1132165131651316153naming it á ú í à            | 1.8964468458152932 | 2004-10-19 10:23:54 | f
 intervalMOẰNAJFK                                  | 1946.5770953294946 | 2004-10-19 10:23:54 | f
 <>?}|!@#$%^&*()_+J%-2i30                          | 0.1878209798396722 | 0001-01-01 00:00:00 | f
 มีวันที่ดีpaintings                                    |  2.178745008516407 | 2000-01-01 00:00:00 | t
 que tenga un lindo día030-1923=0                  | 0.9332050640542904 | 2008-10-19 10:23:54 | f
 Tjos os tres difficileSort                        |  4.051032487176115 | 2019-10-19 10:23:54 | f
 <town>Toronto</town>txid txid                     | 1.8196202531645569 | 2000-01-01 00:00:00 | t
 ()ƯEFJAFquantiry                                  | 0.9900990099009901 | 3999-12-31 23:59:58 | t
 ~!@#$!@#!@#@#格納用のドキュメント                 |  4.416607323988628 | 2008-10-19 10:23:54 | t
 システム設計検討資料チャート作成anything possible | 259.46234676395164 | 2019-10-19 10:23:54 | t
(10 rows)

--Testcase 155:
EXPLAIN VERBOSE SELECT count(*), count(c1), avg(c6)+stddev(c5), sum(c4/12) FROM tbl_pushdown WHERE c4 <> 0 HAVING count(*) >= 0 LIMIT 1 OFFSET 0;
                                                                                                                            QUERY PLAN                                                                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=15.01..15.03 rows=1 width=56)
   Output: (count(*)), (count(c1)), (((avg(c6))::double precision + stddev(c5))), (sum((c4 / 12)))
   ->  Aggregate  (cost=15.01..15.03 rows=1 width=56)
         Output: count(*), count(c1), ((avg(c6))::double precision + stddev(c5)), sum((c4 / 12))
         Filter: (count(*) >= 0)
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=52)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "c4" : { "$ne" : { "$numberInt" : "0" } } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(9 rows)

--Testcase 156:
SELECT count(*), count(c1), avg(c6)+stddev(c5), sum(c4/12) FROM tbl_pushdown WHERE c4 <> 0 HAVING count(*) >= 0 LIMIT 1 OFFSET 0;
 count | count |     ?column?      |  sum   
-------+-------+-------------------+--------
    10 |    10 | 3107659.238542733 | 767572
(1 row)

--Testcase 157:
EXPLAIN VERBOSE SELECT string_agg(c2, ':'), string_agg(c1, ':') FROM tbl_pushdown WHERE c1 != c2 GROUP BY c1, c2 HAVING max(c5) > 0 LIMIT 5 OFFSET 0;
                                                                                                   QUERY PLAN                                                                                                    
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=12.50..12.76 rows=5 width=612)
   Output: (string_agg((c2)::text, ':'::text)), (string_agg(c1, ':'::text)), c1, c2
   ->  HashAggregate  (cost=12.50..16.00 rows=67 width=612)
         Output: string_agg((c2)::text, ':'::text), string_agg(c1, ':'::text), c1, c2
         Group Key: tbl_pushdown.c1, tbl_pushdown.c2
         Filter: (max(tbl_pushdown.c5) > '0'::double precision)
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=556)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "c1" : { "$ne" : null } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" } } } ] }
(10 rows)

--Testcase 158:
SELECT string_agg(c2, ':'), string_agg(c1, ':') FROM tbl_pushdown WHERE c1 != c2 GROUP BY c1, c2 HAVING max(c5) > 0 LIMIT 5 OFFSET 0;
  string_agg   |    string_agg     
---------------+-------------------
 JFQO#@(JWAE)@ | anything possible
 akejf923!O@   | J%-2i30
 ごきげんよう  | naming it á ú í à
 J#PR          | Sort
 ~!@#$%^&*()_+ | 030-1923=0
(5 rows)

--Testcase 159:
EXPLAIN VERBOSE SELECT c1 || '_!)#', c2 || c3, c5*c6/c4+23 FROM tbl_pushdown WHERE c4 >= 0 GROUP BY c1, c2, c3, c4, c5, c6 HAVING c5 - c6 > 0 LIMIT 5 OFFSET 1;
                                                                                                                                                           QUERY PLAN                                                                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=15.03..15.18 rows=5 width=1664)
   Output: ((c1 || '_!)#'::text)), (((c2)::text || (c3)::text)), ((((c5 * (c6)::double precision) / (c4)::double precision) + '23'::double precision)), c1, c2, c3, c4, c5, c6
   ->  HashAggregate  (cost=15.00..21.00 rows=200 width=1664)
         Output: (c1 || '_!)#'::text), ((c2)::text || (c3)::text), (((c5 * (c6)::double precision) / (c4)::double precision) + '23'::double precision), c1, c2, c3, c4, c5, c6
         Group Key: tbl_pushdown.c1, tbl_pushdown.c2, tbl_pushdown.c3, tbl_pushdown.c4, tbl_pushdown.c5, tbl_pushdown.c6
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1592)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Filter: ((tbl_pushdown.c5 - (tbl_pushdown.c6)::double precision) > '0'::double precision)
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "c4" : { "$gte" : { "$numberInt" : "0" } } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(10 rows)

--Testcase 160:
SELECT c1 || '_!)#', c2 || c3, c5*c6/c4+23 FROM tbl_pushdown WHERE c4 >= 0 GROUP BY c1, c2, c3, c4, c5, c6 HAVING c5 - c6 > 0 LIMIT 5 OFFSET 1;
    ?column?    |              ?column?               |      ?column?      
----------------+-------------------------------------+--------------------
 MOẰNAJFK_!)#   | fat20 & ()\\interval                | 23.000062898412835
 030-1923=0_!)# | ~!@#$%^&*()_+que tenga un lindo día |  196.5981441113235
(2 rows)

--logic operator: select
--Testcase 161:
EXPLAIN VERBOSE SELECT c1 != '#' AND true, c2 = 'ABCSD' OR false, c5 >= 0 AND c6 > 0, c4 <> 0 OR c3 IS NOT NULL FROM tbl_pushdown;
                                                                                                                      QUERY PLAN                                                                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..12.50 rows=1000 width=4)
   Output: (c1 <> '#'::text), ((c2)::text = 'ABCSD'::text), ((c5 >= '0'::double precision) AND (c6 > 0)), ((c4 <> 0) OR (c3 IS NOT NULL))
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 162:
SELECT c1 != '#' AND true, c2 = 'ABCSD' OR false, c5 >= 0 AND c6 > 0, c4 <> 0 OR c3 IS NOT NULL FROM tbl_pushdown;
 ?column? | ?column? | ?column? | ?column? 
----------+----------+----------+----------
 t        | f        | f        | t
 t        | f        | f        | t
 t        | f        | f        | t
 t        | f        | t        | t
 t        | f        | f        | t
 t        | f        | t        | t
 t        | f        | t        | t
 t        | f        | t        | t
 t        | f        | t        | t
 t        | f        | t        | t
(10 rows)

--Testcase 163:
EXPLAIN VERBOSE SELECT NOT c1 IS NULL, c2 != '#$', NOT c5 <= 0, NOT c4/c6 = 23 FROM tbl_pushdown;
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..10.00 rows=1000 width=4)
   Output: (c1 IS NOT NULL), ((c2)::text <> '#$'::text), (c5 > '0'::double precision), ((c4 / c6) <> 23)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 164:
SELECT NOT c1 IS NULL, c2 != '#$', NOT c5 <= 0, NOT c4/c6 = 23 FROM tbl_pushdown;
 ?column? | ?column? | ?column? | ?column? 
----------+----------+----------+----------
 t        | t        | f        | t
 t        | t        | f        | t
 t        | t        | f        | t
 t        | t        | t        | t
 t        | t        | f        | t
 t        | t        | t        | t
 t        | t        | t        | t
 t        | t        | t        | t
 t        | t        | t        | t
 t        | t        | t        | t
(10 rows)

--Testcase 165:
EXPLAIN VERBOSE SELECT c1 || '#@)!' = '#@)!' OR c2 || c3 != '#@#', NOT c10, c5 <> c6 FROM tbl_pushdown;
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..17.50 rows=1000 width=3)
   Output: (((c1 || '#@)!'::text) = '#@)!'::text) OR (((c2)::text || (c3)::text) <> '#@#'::text)), (NOT c10), (c5 <> (c6)::double precision)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 166:
SELECT c1 || '#@)!' = '#@)!' OR c2 || c3 != '#@#', NOT c10, c5 <> c6 FROM tbl_pushdown;
 ?column? | ?column? | ?column? 
----------+----------+----------
 t        | f        | t
 t        | f        | t
 t        | f        | t
 t        | t        | t
 t        | t        | t
 t        | t        | t
 t        | f        | t
 t        | t        | t
 t        | f        | t
 t        | t        | t
(10 rows)

--Testcase 167:
EXPLAIN VERBOSE SELECT c1 || c2, c5 > 0, c4 < 0 AND c6 >= 0 FROM tbl_pushdown;
                                                                                                      QUERY PLAN                                                                                                       
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..10.00 rows=1000 width=34)
   Output: (c1 || (c2)::text), (c5 > '0'::double precision), ((c4 < 0) AND (c6 >= 0))
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 168:
SELECT c1 || c2, c5 > 0, c4 < 0 AND c6 >= 0 FROM tbl_pushdown;
            ?column?            | ?column? | ?column? 
--------------------------------+----------+----------
 paintings012803192             | f        | f
 txid txidсковорода             | f        | f
 quantiryハンサム               | f        | f
 naming it á ú í àごきげんよう  | t        | f
 MOẰNAJFKfat20 & ()\\           | f        | f
 J%-2i30akejf923!O@             | t        | t
 格納用のドキュメントĐẹp trai   | t        | t
 030-1923=0~!@#$%^&*()_+        | t        | f
 anything possibleJFQO#@(JWAE)@ | t        | f
 SortJ#PR                       | t        | f
(10 rows)

--Testcase 169:
EXPLAIN VERBOSE SELECT c4 <> 0 AND c5 <= 0, (c7->'values'->>1)::float8 >= 0 OR (c7->'values'->>2)::float8 <> 0 FROM tbl_pushdown;
                                                                                                        QUERY PLAN                                                                                                         
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..30.00 rows=1000 width=2)
   Output: ((c4 <> 0) AND (c5 <= '0'::double precision)), (((((c7 -> 'values'::text) ->> 1))::double precision >= '0'::double precision) OR ((((c7 -> 'values'::text) ->> 2))::double precision <> '0'::double precision))
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c7" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 170:
SELECT c4 <> 0 AND c5 <= 0, (c7->'values'->>1)::float8 >= 0 OR (c7->'values'->>2)::float8 <> 0 FROM tbl_pushdown;
 ?column? | ?column? 
----------+----------
 t        | t
 t        | t
 t        | t
 f        | t
 t        | t
 f        | t
 f        | t
 f        | t
 f        | t
 f        | t
(10 rows)

--Testcase 171:
EXPLAIN VERBOSE SELECT stddev((c7->'values'->>1)::float8) > 0 AND avg(c4-c5) <> 0, sum(c6/2) <> avg(c4), count(c2) > 2 OR sum(c6) > -1 FROM tbl_pushdown;
                                                                                                                        QUERY PLAN                                                                                                                         
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=32.51..32.53 rows=1 width=3)
   Output: ((stddev((((c7 -> 'values'::text) ->> 1))::double precision) > '0'::double precision) AND (avg(((c4)::double precision - c5)) <> '0'::double precision)), ((sum((c6 / 2)))::numeric <> avg(c4)), ((count(c2) > 2) OR (sum(c6) > '-1'::integer))
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=568)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c2" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c7" : { "$numberInt" : "1" } } } ] }
(6 rows)

--Testcase 172:
SELECT stddev((c7->'values'->>1)::float8) > 0 AND avg(c4-c5) <> 0, sum(c6/2) <> avg(c4), count(c2) > 2 OR sum(c6) > -1 FROM tbl_pushdown;
 ?column? | ?column? | ?column? 
----------+----------+----------
 t        | t        | t
(1 row)

--logic operator: select, where
--Testcase 173:
EXPLAIN VERBOSE SELECT c9 + '1 hour'::interval > '0001-01-01 00:00:00' OR c1 != '32@', c2 IS NOT NULL AND c3 IS NOT NULL FROM tbl_pushdown WHERE c1 <> c2 AND c3 IS NOT NULL AND c4 >= 0;
                                                                                                                                                            QUERY PLAN                                                                                                                                                            
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..7.50 rows=1000 width=2)
   Output: (((c9 + '@ 1 hour'::interval) > '0001-01-01 00:00:00'::timestamp without time zone) OR (c1 <> '32@'::text)), ((c2 IS NOT NULL) AND (c3 IS NOT NULL))
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "$and" : [ { "c3" : { "$ne" : null } }, { "c1" : { "$ne" : null } }, { "c4" : { "$gte" : { "$numberInt" : "0" } } } ] } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 174:
SELECT c9 + '1 hour'::interval > '0001-01-01 00:00:00' OR c1 != '32@', c2 IS NOT NULL AND c3 IS NOT NULL FROM tbl_pushdown WHERE c1 <> c2 AND c3 IS NOT NULL AND c4 >= 0;
 ?column? | ?column? 
----------+----------
 t        | t
 t        | t
 t        | t
 t        | t
 t        | t
 t        | t
 t        | t
 t        | t
(8 rows)

--Testcase 175:
EXPLAIN VERBOSE SELECT c9 != '0001-01-01 00:00:00' OR c10 = true, c4 + c5/c6 > c6 AND c10 != true FROM tbl_pushdown WHERE c9 != '2000-01-01 00:00:00' OR c4 IN (2, 3, 34);
                                                                                                                                                                                                             QUERY PLAN                                                                                                                                                                                                             
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..17.50 rows=1000 width=2)
   Output: ((c9 <> '0001-01-01 00:00:00'::timestamp without time zone) OR c10), ((((c4)::double precision + (c5 / (c6)::double precision)) > (c6)::double precision) AND (NOT c10))
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "$or" : [ { "c9" : { "$ne" : { "$date" : { "$numberLong" : "946684800000" } } } }, { "c4" : { "$in" : [ { "$numberLong" : "2"}, { "$numberLong" : "3"}, { "$numberLong" : "34"} ] } } ] } }, { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 176:
SELECT c9 != '0001-01-01 00:00:00' OR c10 = true, c4 + c5/c6 > c6 AND c10 != true FROM tbl_pushdown WHERE c9 != '2000-01-01 00:00:00' OR c4 IN (2, 3, 34);
 ?column? | ?column? 
----------+----------
 t        | f
 t        | t
 t        | t
 f        | f
 t        | f
 t        | t
 t        | f
 t        | t
(8 rows)

--Testcase 177:
EXPLAIN VERBOSE SELECT NOT c8->'teams'->>'name' = 'NOEJAF203', c8->'teams'->'parent'->>'name' <> 'O)#JA' AND (c8->'teams'->'parent'->>'id')::bigint != 233 FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' = 'team1' AND c4 NOT IN (12, 23, -3232);
                                                                                                                   QUERY PLAN                                                                                                                   
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..32.50 rows=1000 width=2)
   Output: (((c8 -> 'teams'::text) ->> 'name'::text) <> 'NOEJAF203'::text), (((((c8 -> 'teams'::text) -> 'parent'::text) ->> 'name'::text) <> 'O)#JA'::text) AND (((((c8 -> 'teams'::text) -> 'parent'::text) ->> 'id'::text))::bigint <> 233))
   Filter: ((((tbl_pushdown.c8 -> 'teams'::text) -> 'parent'::text) ->> 'name'::text) = 'team1'::text)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "c4" : { "$nin" : [ { "$numberLong" : "12"}, { "$numberLong" : "23"}, { "$numberLong" : "-3232"} ] } } }, { "$project" : { "c8" : { "$numberInt" : "1" } } } ] }
(5 rows)

--Testcase 178:
SELECT NOT c8->'teams'->>'name' = 'NOEJAF203', c8->'teams'->'parent'->>'name' <> 'O)#JA' AND (c8->'teams'->'parent'->>'id')::bigint != 233 FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' = 'team1' AND c4 NOT IN (12, 23, -3232);
 ?column? | ?column? 
----------+----------
 t        | t
 t        | t
 t        | t
 t        | t
 t        | t
(5 rows)

--logic operator: select, where, having
--Testcase 179:
EXPLAIN VERBOSE SELECT c4-c5, c6 > 0 AND c3 != '#' FROM tbl_pushdown WHERE c1 || c2 != c3 AND c4 >= 0 OR c5 IN (22.12, 233.23) GROUP BY c1, c3, c4, c5, c6 HAVING c1 != '@)@#' OR c1 <> 'AJWEF@QKIP';
                                                                                                                                                                          QUERY PLAN                                                                                                                                                                           
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=12.50..16.50 rows=200 width=1085)
   Output: ((c4)::double precision - c5), ((c6 > 0) AND (c3 <> '#'::bpchar)), c1, c3, c4, c5, c6
   Group Key: tbl_pushdown.c1, tbl_pushdown.c3, tbl_pushdown.c4, tbl_pushdown.c5, tbl_pushdown.c6
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1076)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: ((((tbl_pushdown.c1 || (tbl_pushdown.c2)::text) <> (tbl_pushdown.c3)::text) AND (tbl_pushdown.c4 >= 0)) OR (tbl_pushdown.c5 = ANY ('{22.12,233.23}'::double precision[])))
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "$or" : [ { "c1" : { "$ne" : "@)@#" } }, { "c1" : { "$ne" : "AJWEF@QKIP" } } ] } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 180:
SELECT c4-c5, c6 > 0 AND c3 != '#' FROM tbl_pushdown WHERE c1 || c2 != c3 AND c4 >= 0 OR c5 IN (22.12, 233.23) GROUP BY c1, c3, c4, c5, c6 HAVING c1 != '@)@#' OR c1 <> 'AJWEF@QKIP';
      ?column?      | ?column? 
--------------------+----------
 -657394.1199999992 | t
              168.2 | t
           6240.121 | t
            200.788 | t
         23123.1212 | f
         23180.2366 | t
             424.12 | t
             392.88 | t
(8 rows)

--Testcase 181:
EXPLAIN VERBOSE SELECT c1 = 'RA#' OR true, c3, c5+c6, c10 OR true FROM tbl_pushdown WHERE c3 >= '$' OR c1 IS NOT NULL GROUP BY c1, c3, c4, c5, c6, c10 HAVING c4 <= 0 OR c5 <> 0 AND c4-c5 > 0;
                                                                                                                                                                      QUERY PLAN                                                                                                                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=15.00..21.00 rows=400 width=1087)
   Output: true, c3, (c5 + (c6)::double precision), true, c1, c4, c5, c6, c10
   Group Key: tbl_pushdown.c1, tbl_pushdown.c3, tbl_pushdown.c4, tbl_pushdown.c5, tbl_pushdown.c6, tbl_pushdown.c10
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1077)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: ((tbl_pushdown.c4 <= 0) OR ((tbl_pushdown.c5 <> '0'::double precision) AND (((tbl_pushdown.c4)::double precision - tbl_pushdown.c5) > '0'::double precision)))
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "$or" : [ { "c3" : { "$gte" : "$" } }, { "c1" : { "$ne" : null } } ] } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 182:
SELECT c1 = 'RA#' OR true, c3, c5+c6, c10 OR true FROM tbl_pushdown WHERE c3 >= '$' OR c1 IS NOT NULL GROUP BY c1, c3, c4, c5, c6, c10 HAVING c4 <= 0 OR c5 <> 0 AND c4-c5 > 0;
 ?column? |                                                                                                                                       c3                                                                                                                                        |   ?column?   | ?column? 
----------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------+----------
 t        | Tjos os tres difficile                                                                                                                                                                                                                                                          |      1374.12 | t
 t        | システム設計検討資料チャート作成                                                                                                                                                                                                                                                |     555.7634 | t
 t        | \\1132165131651316153                                                                                                                                                                                                                                                           |      134.212 | t
 t        | <>?}|!@#$%^&*()_+                                                                                                                                                                                                                                                               | 123135.91231 | t
 t        | มีวันที่ดี                                                                                                                                                                                                                                                                           |    -1877.121 | t
 t        | ~!@#$!@#!@#@#                                                                                                                                                                                                                                                                   |    254.98394 | t
 t        | interval                                                                                                                                                                                                                                                                        |     -12.1212 | t
 t        | ()ƯEFJAF                                                                                                                                                                                                                                                                        |      -210.12 | t
 t        | <town>Toronto</town>                                                                                                                                                                                                                                                            |        -43.2 | t
(9 rows)

--Testcase 183:
EXPLAIN VERBOSE SELECT count(c5), avg(c4), c2 >= '@#' OR true, c9, c10 AND true FROM tbl_pushdown WHERE NOT c10 = false OR c4 <> 0 GROUP BY c2, c4, c5, c6, c9, c10 HAVING c2 IN ('012803192', 'ハンサム', 'ごきげんよう', '~!@#$%^&*()_+') OR c5 >= 0 AND c6 <= 0;
                                                                                                                                                                                                                                              QUERY PLAN                                                                                                                                                                                                                                               
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=20.00..25.00 rows=400 width=587)
   Output: count(c5), avg(c4), true, c9, c10, c2, c4, c5, c6, c10
   Group Key: tbl_pushdown.c2, tbl_pushdown.c4, tbl_pushdown.c5, tbl_pushdown.c6, tbl_pushdown.c9, tbl_pushdown.c10
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=545)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: (tbl_pushdown.c10 OR (tbl_pushdown.c4 <> 0))
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "$or" : [ { "c2" : { "$in" : [ "012803192", "ハンサム", "ごきげんよう", "~!@#$%^&*()_+" ] } }, { "$and" : [ { "c5" : { "$gte" : { "$numberDouble" : "0.0" } } }, { "c6" : { "$lte" : { "$numberInt" : "0" } } } ] } ] } }, { "$project" : { "c2" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c9" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 184:
SELECT count(c5), avg(c4), c2 >= '@#' OR true, c9, c10 AND true FROM tbl_pushdown WHERE NOT c10 = false OR c4 <> 0 GROUP BY c2, c4, c5, c6, c9, c10 HAVING c2 IN ('012803192', 'ハンサム', 'ごきげんよう', '~!@#$%^&*()_+') OR c5 >= 0 AND c6 <= 0;
 count |          avg          | ?column? |         c9          | ?column? 
-------+-----------------------+----------+---------------------+----------
     1 |  9182318.000000000000 | t        | 2008-10-19 10:23:54 | f
     1 |  212.0000000000000000 | t        | 2004-10-19 10:23:54 | f
     1 | 4312.0000000000000000 | t        | 2000-01-01 00:00:00 | t
     1 |  212.0000000000000000 | t        | 3999-12-31 23:59:58 | t
(4 rows)

--Testcase 185:
EXPLAIN VERBOSE SELECT c7->>'key', c7->>'values', c7->>'events' FROM tbl_pushdown WHERE c6 < c4-c5;
                                                                                       QUERY PLAN                                                                                       
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..7.50 rows=1000 width=96)
   Output: (c7 ->> 'key'::text), (c7 ->> 'values'::text), (c7 ->> 'events'::text)
   Filter: ((tbl_pushdown.c6)::double precision < ((tbl_pushdown.c4)::double precision - tbl_pushdown.c5))
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c7" : { "$numberInt" : "1" } } } ] }
(5 rows)

--Testcase 186:
SELECT c7->>'key', c7->>'values', c7->>'events' FROM tbl_pushdown WHERE c6 < c4-c5;
   ?column?   |                 ?column?                 |                   ?column?                    
--------------+------------------------------------------+-----------------------------------------------
 gpl-2.0      | [ 68.0, 12.400000000000000355, -23.0 ]   | [ "update", "roll_back", "create", "delete" ]
 apache-2.0   | [ 0.0, 12.199999999999999289, -23.0 ]    | [ "update", "roll_back", "create", "delete" ]
 bsd-2-clause | [ -313.0, 12.099999999999999645, -23.0 ] | [ "update", "roll_back", "create", "delete" ]
 bsd-3-clause | [ 2.0, 56.600000000000001421, -23.0 ]    | [ "update", "roll_back", "create", "delete" ]
 bsl-1.0      | [ 4.0, 656.20000000000004547, -23.0 ]    | [ "update", "roll_back", "create", "delete" ]
 mpl-2.0      | [ 676.0, 232.32099999999999795, -23.0 ]  | [ "update", "roll_back", "create", "delete" ]
(6 rows)

--comparison operator: where
--Testcase 187:
EXPLAIN VERBOSE SELECT c10, c6+c5-c4, c3 || ' OR ' || c1 FROM tbl_pushdown WHERE c10 != false;
                                                                                                                      QUERY PLAN                                                                                                                       
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..17.50 rows=1000 width=41)
   Output: c10, (((c6)::double precision + c5) - (c4)::double precision), (((c3)::text || ' OR '::text) || c1)
   Filter: tbl_pushdown.c10
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(5 rows)

--Testcase 188:
SELECT c10, c6+c5-c4, c3 || ' OR ' || c1 FROM tbl_pushdown WHERE c10 != false;
 c10 |  ?column?   |                       ?column?                        
-----+-------------+-------------------------------------------------------
 t   |   -6189.121 | มีวันที่ดี OR paintings
 t   |      -158.2 | <town>Toronto</town> OR txid txid
 t   |     -422.12 | ()ƯEFJAF OR quantiry
 t   |  1177.98394 | ~!@#$!@#!@#@# OR 格納用のドキュメント
 t   | -22857.2366 | システム設計検討資料チャート作成 OR anything possible
(5 rows)

--Testcase 189:
EXPLAIN VERBOSE SELECT c3, c2, c5+c6/c4, c5+12, c6*10 FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' = 'team1' OR c5 NOT IN (12.12, 132.21, 0.12, -53.2);
                                                                                                                      QUERY PLAN                                                                                                                      
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..12.50 rows=1000 width=1560)
   Output: c3, c2, (c5 + ((c6 / c4))::double precision), (c5 + '12'::double precision), (c6 * 10)
   Filter: (((((tbl_pushdown.c8 -> 'teams'::text) -> 'parent'::text) ->> 'name'::text) = 'team1'::text) OR (tbl_pushdown.c5 <> ALL ('{12.12,132.21,0.12,-53.2}'::double precision[])))
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$project" : { "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c8" : { "$numberInt" : "1" } } } ] }
(5 rows)

--Testcase 190:
SELECT c3, c2, c5+c6/c4, c5+12, c6*10 FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' = 'team1' OR c5 NOT IN (12.12, 132.21, 0.12, -53.2);
                                                                                                                                       c3                                                                                                                                        |      c2       |   ?column?   |   ?column?   | ?column? 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+--------------+--------------+----------
 มีวันที่ดี                                                                                                                                                                                                                                                                           | 012803192     |    -1928.121 |    -1916.121 |      510
 <town>Toronto</town>                                                                                                                                                                                                                                                            | сковорода     |        -53.2 |        -41.2 |      100
 ()ƯEFJAF                                                                                                                                                                                                                                                                        | ハンサム      |      -212.12 |      -200.12 |       20
 \\1132165131651316153                                                                                                                                                                                                                                                           | ごきげんよう  |       11.212 |       23.212 |     1230
 interval                                                                                                                                                                                                                                                                        | fat20 & ()\\  |      -0.1212 |      11.8788 |     -120
 <>?}|!@#$%^&*()_+                                                                                                                                                                                                                                                               | akejf923!O@   | 123123.91231 | 123135.91231 |      120
 ~!@#$!@#!@#@#                                                                                                                                                                                                                                                                   | Đẹp trai      |    231.98394 |    243.98394 |      230
 que tenga un lindo día                                                                                                                                                                                                                                                          | ~!@#$%^&*()_+ |   9839712.12 |   9839724.12 |     1620
 システム設計検討資料チャート作成                                                                                                                                                                                                                                                | JFQO#@(JWAE)@ |     232.7634 |     244.7634 |     3230
 Tjos os tres difficile                                                                                                                                                                                                                                                          | J#PR          |       839.12 |       851.12 |     5350
(10 rows)

--Testcase 191:
EXPLAIN VERBOSE SELECT c7->>'name', c7->>'key', c7->'events'->1, c7->'events'->>2, c7->'values'->>1 FROM tbl_pushdown WHERE c4 != 0;
                                                                       QUERY PLAN                                                                        
---------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..20.00 rows=1000 width=160)
   Output: (c7 ->> 'name'::text), (c7 ->> 'key'::text), ((c7 -> 'events'::text) -> 1), ((c7 -> 'events'::text) ->> 2), ((c7 -> 'values'::text) ->> 1)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "c4" : { "$ne" : { "$numberInt" : "0" } } } }, { "$project" : { "c7" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 192:
SELECT c7->>'name', c7->>'key', c7->'events'->1, c7->'events'->>2, c7->'values'->>1 FROM tbl_pushdown WHERE c4 != 0;
                ?column?                 |   ?column?   |  ?column?   | ?column? |       ?column?        
-----------------------------------------+--------------+-------------+----------+-----------------------
 GNU General Public License v2.0         | gpl-2.0      | "roll_back" | create   | 12.400000000000000355
 Apache License 2.0                      | apache-2.0   | "roll_back" | create   | 12.199999999999999289
 BSD 2-Clause "Simplified" License       | bsd-2-clause | "roll_back" | create   | 12.099999999999999645
 BSD 3-Clause "New" or "Revised" License | bsd-3-clause | "roll_back" | create   | 56.600000000000001421
 Boost Software License 1.0              | bsl-1.0      | "roll_back" | create   | 656.20000000000004547
 Creative Commons Zero v1.0 Universal    | cc0-1.0      | "roll_back" | create   | 767.29999999999995453
 Eclipse Public License 2.0              | epl-2.0      | "roll_back" | create   | 12.300000000000000711
 MIT License                             | mit          | "roll_back" | create   | 323.24000000000000909
 Mozilla Public License 2.0              | mpl-2.0      | "roll_back" | create   | 232.32099999999999795
 The Unlicense                           | unlicense    | "roll_back" | create   | 0.4000000000000000222
(10 rows)

--Testcase 193:
EXPLAIN VERBOSE SELECT 2, 23, c1 || '232AF', c4/2, c5+12, c6*12 FROM tbl_pushdown WHERE c4 NOT IN (1221, 2312, 13912);
                                                                                                                                                     QUERY PLAN                                                                                                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Foreign Scan on public.tbl_pushdown  (cost=0.00..10.00 rows=1000 width=60)
   Output: 2, 23, (c1 || '232AF'::text), (c4 / 2), (c5 + '12'::double precision), (c6 * 12)
   Foreign Namespace: enhance_regress.tbl_pushdown
   Query document: { "pipeline" : [ { "$match" : { "c4" : { "$nin" : [ { "$numberLong" : "1221"}, { "$numberLong" : "2312"}, { "$numberLong" : "13912"} ] } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(4 rows)

--Testcase 194:
SELECT 2, 23, c1 || '232AF', c4/2, c5+12, c6*12 FROM tbl_pushdown WHERE c4 NOT IN (1221, 2312, 13912);
 ?column? | ?column? |         ?column?          | ?column? |   ?column?   | ?column? 
----------+----------+---------------------------+----------+--------------+----------
        2 |       23 | paintings232AF            |     2156 |    -1916.121 |      612
        2 |       23 | txid txid232AF            |       57 |        -41.2 |      120
        2 |       23 | quantiry232AF             |      106 |      -200.12 |       24
        2 |       23 | naming it á ú í à232AF    |      106 |       23.212 |     1476
        2 |       23 | MOẰNAJFK232AF             |    11561 |      11.8788 |     -144
        2 |       23 | J%-2i30232AF              |   -11561 | 123135.91231 |      144
        2 |       23 | 格納用のドキュメント232AF |     -461 |    243.98394 |      276
        2 |       23 | 030-1923=0232AF           |  4591159 |   9839724.12 |     1944
        2 |       23 | anything possible232AF    |    11706 |     244.7634 |     3876
        2 |       23 | Sort232AF                 |      616 |       851.12 |     6420
(10 rows)

--comparison operator: where, having
--Testcase 195:
EXPLAIN VERBOSE SELECT c8->'teams'->'parent'->>'name', c8->'teams'->'parent'->>'id' FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' != '@)@!' GROUP BY c4, c8 HAVING c4 <> 0 ;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=5.00..10.00 rows=200 width=104)
   Output: (((c8 -> 'teams'::text) -> 'parent'::text) ->> 'name'::text), (((c8 -> 'teams'::text) -> 'parent'::text) ->> 'id'::text), c4, c8
   Group Key: tbl_pushdown.c4, tbl_pushdown.c8
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=40)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: ((((tbl_pushdown.c8 -> 'teams'::text) -> 'parent'::text) ->> 'name'::text) <> '@)@!'::text)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c4" : { "$ne" : { "$numberInt" : "0" } } } }, { "$project" : { "c4" : { "$numberInt" : "1" }, "c8" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 196:
SELECT c8->'teams'->'parent'->>'name', c8->'teams'->'parent'->>'id' FROM tbl_pushdown WHERE c8->'teams'->'parent'->>'name' != '@)@!' GROUP BY c4, c8 HAVING c4 <> 0 ;
    ?column?     | ?column? 
-----------------+----------
 team1           | 4534163
 team1           | 4534163
 =-~@030-team8   | 4534163
 team1           | 4534163
 team1           | 4534163
 =-~@030-team8   | 4534163
 //_\\||team9;-" | 4579782
 team1           | 4534163
 team3           | 4538778
(9 rows)

--Testcase 197:
EXPLAIN VERBOSE SELECT c1, avg(c4-c5), sum(c6) FROM tbl_pushdown WHERE c4-c5 > c6 GROUP BY c1, c4, c5, c6 HAVING c6 <> c4 + 12;
                                                                                          QUERY PLAN                                                                                          
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=20.00..22.50 rows=200 width=68)
   Output: c1, avg(((c4)::double precision - c5)), sum(c6), c4, c5, c6
   Group Key: tbl_pushdown.c1, tbl_pushdown.c4, tbl_pushdown.c5, tbl_pushdown.c6
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=52)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: ((tbl_pushdown.c6 <> (tbl_pushdown.c4 + 12)) AND (((tbl_pushdown.c4)::double precision - tbl_pushdown.c5) > (tbl_pushdown.c6)::double precision))
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$project" : { "c1" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 198:
SELECT c1, avg(c4-c5), sum(c6) FROM tbl_pushdown WHERE c4-c5 > c6 GROUP BY c1, c4, c5, c6 HAVING c6 <> c4 + 12;
        c1         |    avg     | sum 
-------------------+------------+-----
 paintings         |   6240.121 |  51
 txid txid         |      168.2 |  10
 anything possible | 23180.2366 | 323
 MOẰNAJFK          | 23123.1212 | -12
 naming it á ú í à |    200.788 | 123
 quantiry          |     424.12 |   2
(6 rows)

--Testcase 199:
EXPLAIN VERBOSE SELECT c1, c2, c3, c4, c5, c10 FROM tbl_pushdown WHERE c1 || c2 != 'any string match' GROUP BY 1, 2, 3, 4, 5, 6 HAVING c1 != '%$' AND c2 <> 'All';
                                                                                                                                                                       QUERY PLAN                                                                                                                                                                       
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=15.00..19.00 rows=400 width=1589)
   Output: c1, c2, c3, c4, c5, c10
   Group Key: tbl_pushdown.c1, tbl_pushdown.c2, tbl_pushdown.c3, tbl_pushdown.c4, tbl_pushdown.c5, tbl_pushdown.c10
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=1589)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: ((tbl_pushdown.c1 || (tbl_pushdown.c2)::text) <> 'any string match'::text)
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "$and" : [ { "c1" : { "$ne" : "%$" } }, { "c2" : { "$ne" : "All" } } ] } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c3" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c10" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 200:
SELECT c1, c2, c3, c4, c5, c10 FROM tbl_pushdown WHERE c1 || c2 != 'any string match' GROUP BY 1, 2, 3, 4, 5, 6 HAVING c1 != '%$' AND c2 <> 'All';
          c1          |      c2       |                                                                                                                                       c3                                                                                                                                        |   c4    |      c5      | c10 
----------------------+---------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------+--------------+-----
 txid txid            | сковорода     | <town>Toronto</town>                                                                                                                                                                                                                                                            |     115 |        -53.2 | t
 paintings            | 012803192     | มีวันที่ดี                                                                                                                                                                                                                                                                           |    4312 |    -1928.121 | t
 Sort                 | J#PR          | Tjos os tres difficile                                                                                                                                                                                                                                                          |    1232 |       839.12 | f
 naming it á ú í à    | ごきげんよう  | \\1132165131651316153                                                                                                                                                                                                                                                           |     212 |       11.212 | f
 anything possible    | JFQO#@(JWAE)@ | システム設計検討資料チャート作成                                                                                                                                                                                                                                                |   23413 |     232.7634 | t
 J%-2i30              | akejf923!O@   | <>?}|!@#$%^&*()_+                                                                                                                                                                                                                                                               |  -23123 | 123123.91231 | f
 quantiry             | ハンサム      | ()ƯEFJAF                                                                                                                                                                                                                                                                        |     212 |      -212.12 | t
 030-1923=0           | ~!@#$%^&*()_+ | que tenga un lindo día                                                                                                                                                                                                                                                          | 9182318 |   9839712.12 | f
 MOẰNAJFK             | fat20 & ()\\  | interval                                                                                                                                                                                                                                                                        |   23123 |      -0.1212 | f
 格納用のドキュメント | Đẹp trai      | ~!@#$!@#!@#@#                                                                                                                                                                                                                                                                   |    -923 |    231.98394 | t
(10 rows)

--Testcase 201:
EXPLAIN VERBOSE SELECT c1, avg(c4), c2, sum(c6), c5 FROM tbl_pushdown WHERE c4-c6 > c4 -c5 GROUP BY c1, c2, c6, c5 HAVING c6 >= 0;
                                                                                                                                         QUERY PLAN                                                                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 HashAggregate  (cost=15.00..17.50 rows=200 width=600)
   Output: c1, avg(c4), c2, sum(c6), c5, c6
   Group Key: tbl_pushdown.c1, tbl_pushdown.c2, tbl_pushdown.c6, tbl_pushdown.c5
   ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=568)
         Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
         Filter: (((tbl_pushdown.c4 - tbl_pushdown.c6))::double precision > ((tbl_pushdown.c4)::double precision - tbl_pushdown.c5))
         Foreign Namespace: enhance_regress.tbl_pushdown
         Query document: { "pipeline" : [ { "$match" : { "c6" : { "$gte" : { "$numberInt" : "0" } } } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c2" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(8 rows)

--Testcase 202:
SELECT c1, avg(c4), c2, sum(c6), c5 FROM tbl_pushdown WHERE c4-c6 > c4 -c5 GROUP BY c1, c2, c6, c5 HAVING c6 >= 0;
          c1          |          avg          |      c2       | sum |      c5      
----------------------+-----------------------+---------------+-----+--------------
 030-1923=0           |  9182318.000000000000 | ~!@#$%^&*()_+ | 162 |   9839712.12
 格納用のドキュメント | -923.0000000000000000 | Đẹp trai      |  23 |    231.98394
 J%-2i30              |   -23123.000000000000 | akejf923!O@   |  12 | 123123.91231
 Sort                 | 1232.0000000000000000 | J#PR          | 535 |       839.12
(4 rows)

--Testcase 203:
EXPLAIN VERBOSE SELECT stddev((c7->'values'->>1)::float8), avg((c7->'values'->>2)::float8), avg((c7->'values'->>1)::float8), stddev_samp((c7->'values'->>2)::float8) FROM tbl_pushdown WHERE c4-c6 > c4-c5 GROUP BY c6 HAVING c6 >= 0 LIMIT 5;
                                                                                                                             QUERY PLAN                                                                                                                              
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=27.50..27.60 rows=5 width=36)
   Output: (stddev((((c7 -> 'values'::text) ->> 1))::double precision)), (avg((((c7 -> 'values'::text) ->> 2))::double precision)), (avg((((c7 -> 'values'::text) ->> 1))::double precision)), (stddev_samp((((c7 -> 'values'::text) ->> 2))::double precision)), c6
   ->  HashAggregate  (cost=27.50..31.50 rows=200 width=36)
         Output: stddev((((c7 -> 'values'::text) ->> 1))::double precision), avg((((c7 -> 'values'::text) ->> 2))::double precision), avg((((c7 -> 'values'::text) ->> 1))::double precision), stddev_samp((((c7 -> 'values'::text) ->> 2))::double precision), c6
         Group Key: tbl_pushdown.c6
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=36)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Filter: (((tbl_pushdown.c4 - tbl_pushdown.c6))::double precision > ((tbl_pushdown.c4)::double precision - tbl_pushdown.c5))
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "c6" : { "$gte" : { "$numberInt" : "0" } } } }, { "$project" : { "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" }, "c7" : { "$numberInt" : "1" } } } ] }
(10 rows)

--Testcase 204:
SELECT * FROM (
SELECT stddev((c7->'values'->>1)::float8), avg((c7->'values'->>2)::float8), avg((c7->'values'->>1)::float8), stddev_samp((c7->'values'->>2)::float8) FROM tbl_pushdown WHERE c4-c6 > c4-c5 GROUP BY c6 HAVING c6 >= 0 LIMIT 5
) t ORDER BY 1, 2, 3, 4;
 stddev | avg |  avg   | stddev_samp 
--------+-----+--------+-------------
        | -23 |    0.4 |            
        | -23 |   12.3 |            
        | -23 | 323.24 |            
        | -23 |  767.3 |            
(4 rows)

--Testcase 205:
EXPLAIN VERBOSE SELECT '!@_!+', 23, c5+c6/c4, c5+12, abs(c4/(c6-c5)) FROM tbl_pushdown WHERE c4/c6 >= 0 OR c5*c6/c4 < 1000 GROUP BY c5, c4, c6, c1 HAVING c5 <> 0 AND c1 NOT IN ('a3awer', '2323ASE') LIMIT 5 OFFSET 1;
                                                                                                                                                               QUERY PLAN                                                                                                                                                                
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=10.03..10.20 rows=5 width=112)
   Output: '!@_!+'::text, 23, ((c5 + ((c6 / c4))::double precision)), ((c5 + '12'::double precision)), (abs(((c4)::double precision / ((c6)::double precision - c5)))), c5, c4, c6, c1
   ->  HashAggregate  (cost=10.00..16.50 rows=200 width=112)
         Output: '!@_!+'::text, 23, (c5 + ((c6 / c4))::double precision), (c5 + '12'::double precision), abs(((c4)::double precision / ((c6)::double precision - c5))), c5, c4, c6, c1
         Group Key: tbl_pushdown.c5, tbl_pushdown.c4, tbl_pushdown.c6, tbl_pushdown.c1
         ->  Foreign Scan on public.tbl_pushdown  (cost=0.00..0.00 rows=1000 width=52)
               Output: _id, c1, c2, c3, c4, c5, c6, c7, c8, c9, c10
               Filter: (((tbl_pushdown.c4 / tbl_pushdown.c6) >= 0) OR (((tbl_pushdown.c5 * (tbl_pushdown.c6)::double precision) / (tbl_pushdown.c4)::double precision) < '1000'::double precision))
               Foreign Namespace: enhance_regress.tbl_pushdown
               Query document: { "pipeline" : [ { "$match" : { "$and" : [ { "c5" : { "$ne" : { "$numberDouble" : "0.0" } } }, { "c1" : { "$nin" : [ "a3awer", "2323ASE" ] } } ] } }, { "$project" : { "c1" : { "$numberInt" : "1" }, "c4" : { "$numberInt" : "1" }, "c5" : { "$numberInt" : "1" }, "c6" : { "$numberInt" : "1" } } } ] }
(10 rows)

--Testcase 206:
SELECT '!@_!+', 23, c5+c6/c4, c5+12, abs(c4/(c6-c5)) FROM tbl_pushdown WHERE c4/c6 >= 0 OR c5*c6/c4 < 1000 GROUP BY c5, c4, c6, c1 HAVING c5 <> 0 AND c1 NOT IN ('a3awer', '2323ASE') LIMIT 5 OFFSET 1;
 ?column? | ?column? | ?column?  | ?column?  |        abs         
----------+----------+-----------+-----------+--------------------
 !@_!+    |       23 |    11.212 |    23.212 | 1.8964468458152932
 !@_!+    |       23 |   -0.1212 |   11.8788 | 1946.5770953294946
 !@_!+    |       23 | -1928.121 | -1916.121 |  2.178745008516407
 !@_!+    |       23 | 231.98394 | 243.98394 |  4.416607323988628
 !@_!+    |       23 |  232.7634 |  244.7634 | 259.46234676395164
(5 rows)

DROP FOREIGN TABLE tbl_pushdown;
DROP USER MAPPING FOR public SERVER mongo_server;
DROP SERVER mongo_server;
DROP EXTENSION mongo_fdw CASCADE;
